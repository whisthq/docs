
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Other Services &#8212; Fractal Webserver  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module Documentation" href="modules.html" />
    <link rel="prev" title="Stripe Integration" href="stripe.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="other-services">
<h1>Other Services<a class="headerlink" href="#other-services" title="Permalink to this headline">¶</a></h1>
<section id="user-agents">
<h2>User Agents<a class="headerlink" href="#user-agents" title="Permalink to this headline">¶</a></h2>
<p>The Fractal Desktop Applications allow customers to register and log into user accounts. Once a Fractal Desktop Application
is authenticated, it requests that the Fractal Webserver allocates it a Fractal mandelbox, at which point a
streaming session can begin. Developers use tools such as web browsers, Postman, and cURL to perform manual tests against
instances of the Fractal Webserver, and also to perform administrative actions like creating and deleting cloud resources.</p>
</section>
<section id="fractal-host-service">
<h2>Fractal Host Service<a class="headerlink" href="#fractal-host-service" title="Permalink to this headline">¶</a></h2>
<p>The Fractal Host Service is responsible for orchestrating mandelbox allocation and interaction on a host machine.
It listens for connections from the Fractal Webserver, which periodically sends commands and data that influence how and when
application streaming sessions start and run to the Fractal Host Service on a specific host machine. It is also
responsible for handling properly setting up Fractal mandelboxes and their interaction with the host, notably via allocating
TTYs and Uinput nodes. The Fractal Host Service also sends periodic heartbeats back to the Fractal Webserver to let it know
that it is alive.</p>
</section>
<section id="fractal-protocol-server">
<h2>Fractal Protocol Server<a class="headerlink" href="#fractal-protocol-server" title="Permalink to this headline">¶</a></h2>
<p>The Fractal Protocol Server is responsible for handling the server-side part of the streaming, and is installed in Fractal
mandelboxes. It notifies the Fractal Webserver when connected clients disconnect, so that the Fractal Webserver knows when
to tell AWS to delete instances that are no longer needed.</p>
</section>
<section id="github-actions-workflows">
<h2>GitHub Actions Workflows<a class="headerlink" href="#github-actions-workflows" title="Permalink to this headline">¶</a></h2>
<p>Each time a new release is deployed on protocol, a GitHub Actions workflow triggers the following steps.</p>
<ol class="arabic simple">
<li><p>Builds the AMIs with the updated version of protocol.</p></li>
<li><p>Invokes the flask cli bundled along with the webserver to create preconfigured buffer capacity.</p></li>
<li><p>Once the instances are up with with the newer AMIs, we atomically switch over from the older AMIs to newer AMIs across all regions.</p></li>
</ol>
</section>
<section id="hirefire">
<h2>HireFire<a class="headerlink" href="#hirefire" title="Permalink to this headline">¶</a></h2>
<p>HireFire is a Heroku add-on that is responsible for scaling our Celery worker processes. The HireFire service periodically
requests scaling metrics from the Fractal Webserver. It uses these metrics to determine the desired number of Celery worker
processes to run and scales the actual number of running Celery worker processes accordingly.</p>
</section>
<section id="databases">
<h2>Databases<a class="headerlink" href="#databases" title="Permalink to this headline">¶</a></h2>
<p>On startup, the Fractal Webserver reads from a centralized database of Flask configuration variables, the <cite>fractal-config</cite>
database, that may be overridden by Heroku environment variables. We call this database the configuration database and it is
shared by all Fractal Webserver deployments, mainly <cite>dev</cite>, <cite>staging</cite> and <cite>prod</cite>. Each Fractal Webserver deployment is also
attached to an all-purpose PostgresSQL database that it uses at runtime. This database keeps track of streaming sessions that
have been initiated by API requests to the associated Fractal Webserver.</p>
</section>
<section id="aws-services">
<h2>AWS Services<a class="headerlink" href="#aws-services" title="Permalink to this headline">¶</a></h2>
<p>The web server is responsible for scaling cloud resources. In particular, it interacts heavily with AWS EC2.
Specifically, the Fractal Webserver has a utility library interface over the AWS EC2 API that allows us to provision and
deprovision cloud resources from Python code easily. Mandelboxes are then handled directory by the Fractal Host Service on the
instance. We use this utility library when scaling up (adding more) or scaling down (shutting off) EC2 instances due to
periods of lower or higher load. Once active, these instances are interfaced with via the Fractal Host Service (see above)
rather than directly via the EC2 API whenever possible. This invariant is only violated when the Fractal Host Service is
malfunctioning, at which point the utility library is used to directly shut down instances.</p>
</section>
<section id="stripe">
<h2>Stripe<a class="headerlink" href="#stripe" title="Permalink to this headline">¶</a></h2>
<p>The Fractal Webserver is responsible for associating Stripe customers with Fractal user accounts managed via Auth0, managing
subscriptions, and granting or denying users service based on their subscription status. We use Stripe to handle all of our
payments infrastructure and it interacts closely with Auth0, which handles all of our authentication infrastructure.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Fractal Webserver</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="responsibilities.html">Webserver Responsibilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="stripe.html">Stripe Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Other Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#user-agents">User Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fractal-host-service">Fractal Host Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fractal-protocol-server">Fractal Protocol Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#github-actions-workflows">GitHub Actions Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hirefire">HireFire</a></li>
<li class="toctree-l2"><a class="reference internal" href="#databases">Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aws-services">AWS Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stripe">Stripe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Module Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="stripe.html" title="previous chapter">Stripe Integration</a></li>
      <li>Next: <a href="modules.html" title="next chapter">Module Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Fractal Computers, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/services.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>