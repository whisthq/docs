
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Webserver Responsibilities &#8212; Whist Webserver  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Stripe Integration" href="stripe.html" />
    <link rel="prev" title="Authentication" href="authentication.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="webserver-responsibilities">
<h1>Webserver Responsibilities<a class="headerlink" href="#webserver-responsibilities" title="Permalink to this headline">¶</a></h1>
<p>The Whist Webserver performs three main functions:</p>
<ul class="simple">
<li><p>Controls which users have access to which compute resources</p></li>
<li><p>Makes sure we have enough compute for the userload we’re seeing, by starting and stopping cloud instances</p></li>
<li><p>Allows users to initiate application streams – i.e. to start using Whist</p></li>
</ul>
<section id="access-control">
<h2>Access Control<a class="headerlink" href="#access-control" title="Permalink to this headline">¶</a></h2>
<p>For each access token that the Whist Webserver receives, it must verify that the authenticated user is authorized to access
the resources to which they are requesting access. For example, some Whist Webserver resources are only accessible to
Whist subscribers, while others are only accessible to Whist administrators. Access tokens are JWTs issued by an Auth0
tenant that takes care of user management and authentication. Each time the Whist Webserver receives one of these access
tokens, it uses the Auth0 tenant’s public signing key to validate the token’s signature. Validating the signature allows the
Whist Webserver to trust that the token was really issued by the Auth0 tenant. Once the signature has been validated, the
Webserver can use the data contained in the token’s payload to determine whether or not the authenticated is authorized to
access the resource to which they are requesting access. In order to enforce access control for resources that are only
accessible to Whist subscribers, the Whist Webserver reads the the authenticated user’s Stripe-issued customer ID from
the token’s payload and uses it to query Stripe’s API for the authenticated user’s Whist subscription status. If the
subscription is in one of the “active” or “trialing” states, they are granted access to the resource. In order to enforce
access control for resources that are only accessible to Whist administrators, the Webserver reads from the token’s payload
the API scopes that the user is authorized to access. If one of those scopes is “admin”, then the user is allowed to access
the resource.</p>
</section>
<section id="compute-scaling">
<h2>Compute Scaling<a class="headerlink" href="#compute-scaling" title="Permalink to this headline">¶</a></h2>
<p>The Whist Webserver continuously keeps track of the amount of load on our system, both in terms of the number of active
users and their actual activity level. Based on this, it starts and stops cloud instances dynamically in order to make sure
everyone who wants a session can have one, ideally without any wait.</p>
</section>
<section id="application-streaming">
<h2>Application Streaming<a class="headerlink" href="#application-streaming" title="Permalink to this headline">¶</a></h2>
<p>By far the most significant and complicated of the Whist Webserver’s responsibilities is that of allocating Whist
mandelboxes to users. When the Webserver receives a request to start streaming an application, the web server must quickly
procure connection information for a running instance of the Whist Protocol Server and return it to the the Whist
Desktop application that requested the streaming session.</p>
<section id="starting-streams">
<h3>Starting Streams<a class="headerlink" href="#starting-streams" title="Permalink to this headline">¶</a></h3>
<p>At a high level, when the Whist Webserver receives a request to allocate a Whist mandelbox to a user, from which an
application stream will begin. It does the following in order:</p>
<p>1. Check for any idle Whist mandelbox that may have been created in advance in order to minimize the amount of time taken
to return an application stream connection information to the client. If any idle Whist mandelbox exist, choose one,
return its connection information to the client, and skip to step 3.
2. Start a new Whist mandelbox on a cloud instance with availability, and return its connection information to the user.
3. Scale the pool of idle Whist mandelboxes based on current idle Whist mandelboxes supply and application stream
demand metrics, creating new cloud instances as necessary.</p>
<p>In order to reduce the amount of time it takes for the Whist Webserver to associate an instance of the Whist client with
an application stream, we “cache,” as it were, some information about the cloud resources that are provisioned and available
to serve Whist mandelboxes. Although it is redundant for us to take it upon ourselves to store some of this information
because we could just as easily obtain it with a query to AWS, in practice it is advantageous to do so because querying
our own database is quicker than querying AWS.</p>
</section>
<section id="ending-streams">
<h3>Ending Streams<a class="headerlink" href="#ending-streams" title="Permalink to this headline">¶</a></h3>
<p>When a user closes a streamed application at the end of their streaming session, the Whist mandelbox running this
application notifies the Whist Webserver that the user has disconnected. At this point, the web server instructs AWS to
delete the mandelbox. All data except for any application-specific configuration vanishes. In other words, every streamed
application (i.e. Whist mandelbox) has an ephemeral hard drive. All data that is persisted between streaming sessions is
encrypted with a user-specific encryption key and uploaded to in AWS S3 before the Whist mandelbox destroys itself. The
encryption key is known only to the end-user, so neither AWS nor Whist employees are able to decrypt and read the users’ data.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Whist Webserver</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Webserver Responsibilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#access-control">Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-scaling">Compute Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-streaming">Application Streaming</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stripe.html">Stripe Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Other Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Module Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="authentication.html" title="previous chapter">Authentication</a></li>
      <li>Next: <a href="stripe.html" title="next chapter">Stripe Integration</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Whist Technologies, Inc. 2021.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/responsibilities.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>