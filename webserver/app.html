
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>app package &#8212; Fractal Webserver  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="app.constants package" href="app.constants.html" />
    <link rel="prev" title="Module Documentation" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="app-package">
<h1>app package<a class="headerlink" href="#app-package" title="Permalink to this headline">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="app.constants.html">app.constants package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#module-app.constants.config_table_names">app.constants.config_table_names module</a></li>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#module-app.constants.ec2_instance_states">app.constants.ec2_instance_states module</a></li>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#module-app.constants.env_names">app.constants.env_names module</a></li>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#module-app.constants.mandelbox_host_states">app.constants.mandelbox_host_states module</a></li>
<li class="toctree-l2"><a class="reference internal" href="app.constants.html#module-app.constants">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="app.helpers.html">app.helpers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="app.helpers.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="app.helpers.blueprint_helpers.html">app.helpers.blueprint_helpers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.blueprint_helpers.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.blueprint_helpers.html#module-app.helpers.blueprint_helpers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="app.helpers.helpers_tests.html">app.helpers.helpers_tests package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.helpers_tests.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.helpers_tests.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.helpers_tests.html#module-app.helpers.helpers_tests.conftest">app.helpers.helpers_tests.conftest module</a></li>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.helpers_tests.html#module-app.helpers.helpers_tests">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="app.helpers.utils.html">app.helpers.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.utils.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="app.helpers.utils.html#module-app.helpers.utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="app.helpers.html#module-app.helpers">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-app.cli">
<span id="app-cli-module"></span><h2>app.cli module<a class="headerlink" href="#module-app.cli" title="Permalink to this headline">¶</a></h2>
<p>Custom Flask CLI extensions</p>
<p>This module contains blueprints that create Flask CLI (sub)commands when they are registered to a
Flask application. See <a class="reference external" href="https://flask.palletsprojects.com/en/2.0.x/cli/#custom-commands">https://flask.palletsprojects.com/en/2.0.x/cli/#custom-commands</a>.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># wsgi.py</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="k">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">app.cli</span> <span class="k">import</span> <span class="n">command_bp</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">command_bp</span><span class="p">)</span>
</pre></div>
</div>
<p>Once a blueprint that defines custom CLI commands has been registered to a Flask application, the
custom commands will appear in the <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">help</span></code> output and can be called as subcommands of
<code class="docutils literal notranslate"><span class="pre">flask</span></code>. For example, the commands defined by the <code class="docutils literal notranslate"><span class="pre">command_bp</span></code> blueprint can be called with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ flask ami create_buffers
...
$ flask ami swap_over_buffers
...
$ flask ami generate_test_data
...
</pre></div>
</div>
</section>
<section id="module-app.config">
<span id="app-config-module"></span><h2>app.config module<a class="headerlink" href="#module-app.config" title="Permalink to this headline">¶</a></h2>
<p>Flask application configuration.</p>
<p>This module contains definitions of objects that are used to configure the Flask application a la
<a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/config/#development-production">https://flask.palletsprojects.com/en/1.1.x/config/#development-production</a>. Depending on the
environment in which the Flask application is being deployed, one of these configuration objects is
selected to be used to configure the application. For example, if the application factory detects
that the application is being deployed during a local test session, LocalTestConfig will be
selected; if the application factory detects that the application is being deployed to production
on Heroku, the DeploymentConfig class will be selected. The configuration object is then
instantiated and the Flask application is configured by flask.Config.from_object().</p>
<dl class="py class">
<dt class="sig sig-object py" id="app.config.DeploymentConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.config.</span></span><span class="sig-name descname"><span class="pre">DeploymentConfig</span></span><a class="headerlink" href="#app.config.DeploymentConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Flask application configuration for deployed applications.</p>
<p>“Deployed applications” are those running on deployment platforms such as Heroku. They must be
started with CONFIG_DB_URL, DATABASE_URL set in the process’s
execution environment.</p>
<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.APP_GIT_BRANCH">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">APP_GIT_BRANCH</span></span><a class="headerlink" href="#app.config.DeploymentConfig.APP_GIT_BRANCH" title="Permalink to this definition">¶</a></dt>
<dd><p>The git branch (i.e. sha) of the source code for this particular instance of the
application.</p>
<p>The current implementation assumes that Heroku is the execution environment. It should fail
if this is not the case (hence os.environ[] instead of os.environ.get()). It supports
standard heroku app environments as well as test environments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.APP_GIT_COMMIT">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">APP_GIT_COMMIT</span></span><a class="headerlink" href="#app.config.DeploymentConfig.APP_GIT_COMMIT" title="Permalink to this definition">¶</a></dt>
<dd><p>The git commit (i.e. sha) of the source code for this particular instance of the
application.</p>
<p>The current implementation assumes that Heroku is the execution environment. It should fail
if this is not the case (hence os.environ[] instead of os.environ.get()). It supports
standard heroku app environments as well as test environments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.AUTH0_DOMAIN">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_DOMAIN</span></span><a class="headerlink" href="#app.config.DeploymentConfig.AUTH0_DOMAIN" title="Permalink to this definition">¶</a></dt>
<dd><p>A domain name identifying the Auth0 tenant with which the Webserver should communicate.
Examples include <code class="docutils literal notranslate"><span class="pre">fractal-dev.us.auth0.com</span></code> and <code class="docutils literal notranslate"><span class="pre">login.fractal.co</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.AUTH0_WEBSERVER_CLIENT_ID">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_WEBSERVER_CLIENT_ID</span></span><a class="headerlink" href="#app.config.DeploymentConfig.AUTH0_WEBSERVER_CLIENT_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>The client ID of the OAuth 2.0 client representing the Webserver registered to the
Auth0 tenant whose domain is <a class="reference internal" href="#app.config.DeploymentConfig.AUTH0_DOMAIN" title="app.config.DeploymentConfig.AUTH0_DOMAIN"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AUTH0_DOMAIN</span></code></a>.</p>
<img alt="_images/clients.png" src="_images/clients.png" />
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.AUTH0_WEBSERVER_CLIENT_SECRET">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_WEBSERVER_CLIENT_SECRET</span></span><a class="headerlink" href="#app.config.DeploymentConfig.AUTH0_WEBSERVER_CLIENT_SECRET" title="Permalink to this definition">¶</a></dt>
<dd><p>The client secret of the OAuth 2.0 client representing the Webserver registered to the
Auth0 tenant whose domain is <a class="reference internal" href="#app.config.DeploymentConfig.AUTH0_DOMAIN" title="app.config.DeploymentConfig.AUTH0_DOMAIN"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AUTH0_DOMAIN</span></code></a>.</p>
<img alt="_images/client_webserver.png" src="_images/client_webserver.png" />
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.AWS_INSTANCE_TYPE_TO_LAUNCH">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AWS_INSTANCE_TYPE_TO_LAUNCH</span></span><a class="headerlink" href="#app.config.DeploymentConfig.AWS_INSTANCE_TYPE_TO_LAUNCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.AWS_TASKS_PER_INSTANCE">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AWS_TASKS_PER_INSTANCE</span></span><a class="headerlink" href="#app.config.DeploymentConfig.AWS_TASKS_PER_INSTANCE" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.DEFAULT_INSTANCE_BUFFER">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">DEFAULT_INSTANCE_BUFFER</span></span><a class="headerlink" href="#app.config.DeploymentConfig.DEFAULT_INSTANCE_BUFFER" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.DESIRED_FREE_MANDELBOXES">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">DESIRED_FREE_MANDELBOXES</span></span><a class="headerlink" href="#app.config.DeploymentConfig.DESIRED_FREE_MANDELBOXES" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.ENVIRONMENT">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ENVIRONMENT</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#app.config.DeploymentConfig.ENVIRONMENT" title="Permalink to this definition">¶</a></dt>
<dd><p>Which environment (production, staging, development, local) is the application
running in?</p>
<p>Many other values are derived off of this, such as which task_definitions to use.</p>
<p>NOTE: As a fallback, the “ENVIRONMENT” key can set to an environment name to
override the automatically calculated environment. If set, the value of ENVIRONMENT
will be returned as is.</p>
<p>NOTE: This assumes the app is running on Heroku. Local configs should override
this property. If a heroku environment is not being used, this method will fail
(unless ENVIRONMENT is set).</p>
<ul class="simple">
<li><p>If Heroku is being used, but the app name is unrecognized, this will default to
development since it’s assumed that a review app is being used (which is effectively a
development deployment).</p></li>
<li><p>If Heroku is being used, and the app is in a test environment, then development
will be returned as the environment.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>&#64;see app.constants.env_names</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.HOST_SERVER">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">HOST_SERVER</span></span><a class="headerlink" href="#app.config.DeploymentConfig.HOST_SERVER" title="Permalink to this definition">¶</a></dt>
<dd><p>A unique identifier representing the server (ie. VM) that this instance of the
application is running on.</p>
<p>The current implementation assumes that Heroku is the execution environment. It should fail
if this is not the case (hence os.environ[] instead of os.environ.get()).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.HOST_SERVICE_PORT">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">HOST_SERVICE_PORT</span></span><a class="headerlink" href="#app.config.DeploymentConfig.HOST_SERVICE_PORT" title="Permalink to this definition">¶</a></dt>
<dd><p>The port on on each EC2 instance on which the host service runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.JWT_ALGORITHM">
<span class="sig-name descname"><span class="pre">JWT_ALGORITHM</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'RS256'</span></em><a class="headerlink" href="#app.config.DeploymentConfig.JWT_ALGORITHM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.JWT_DECODE_ALGORITHMS">
<span class="sig-name descname"><span class="pre">JWT_DECODE_ALGORITHMS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('RS256',)</span></em><a class="headerlink" href="#app.config.DeploymentConfig.JWT_DECODE_ALGORITHMS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.JWT_DECODE_AUDIENCE">
<span class="sig-name descname"><span class="pre">JWT_DECODE_AUDIENCE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'https://api.fractal.co'</span></em><a class="headerlink" href="#app.config.DeploymentConfig.JWT_DECODE_AUDIENCE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.METRICS_SINK_LOCAL_FILE">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">METRICS_SINK_LOCAL_FILE</span></span><a class="headerlink" href="#app.config.DeploymentConfig.METRICS_SINK_LOCAL_FILE" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.METRICS_SINK_LOGZ_TOKEN">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">METRICS_SINK_LOGZ_TOKEN</span></span><a class="headerlink" href="#app.config.DeploymentConfig.METRICS_SINK_LOGZ_TOKEN" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.SENTRY_DSN">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">SENTRY_DSN</span></span><a class="headerlink" href="#app.config.DeploymentConfig.SENTRY_DSN" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.SILENCED_ENDPOINTS">
<span class="sig-name descname"><span class="pre">SILENCED_ENDPOINTS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('/status',</span> <span class="pre">'/ping')</span></em><a class="headerlink" href="#app.config.DeploymentConfig.SILENCED_ENDPOINTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.SQLALCHEMY_DATABASE_URI">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">SQLALCHEMY_DATABASE_URI</span></span><a class="headerlink" href="#app.config.DeploymentConfig.SQLALCHEMY_DATABASE_URI" title="Permalink to this definition">¶</a></dt>
<dd><p>The connection string of the application’s main database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A PostgreSQL connection string whose scheme is guaranteed to be “postgresql”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.SQLALCHEMY_TRACK_MODIFICATIONS">
<span class="sig-name descname"><span class="pre">SQLALCHEMY_TRACK_MODIFICATIONS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">False</span></em><a class="headerlink" href="#app.config.DeploymentConfig.SQLALCHEMY_TRACK_MODIFICATIONS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.STRIPE_CUSTOMER_ID_CLAIM">
<span class="sig-name descname"><span class="pre">STRIPE_CUSTOMER_ID_CLAIM</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'https://api.fractal.co/stripe_customer_id'</span></em><a class="headerlink" href="#app.config.DeploymentConfig.STRIPE_CUSTOMER_ID_CLAIM" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the access token claim containing the ID of the Stripe Customer record
associated with an authenticated user’s Fractal account.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.STRIPE_PRICE_ID">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">STRIPE_PRICE_ID</span></span><a class="headerlink" href="#app.config.DeploymentConfig.STRIPE_PRICE_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>The ID of the Stripe Price object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.STRIPE_SECRET">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">STRIPE_SECRET</span></span><a class="headerlink" href="#app.config.DeploymentConfig.STRIPE_SECRET" title="Permalink to this definition">¶</a></dt>
<dd><p>The API key that the Webserver should use to authenticate itself with the Stripe API.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.STRIPE_SUBSCRIPTION_STATUS_CLAIM">
<span class="sig-name descname"><span class="pre">STRIPE_SUBSCRIPTION_STATUS_CLAIM</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'https://api.fractal.co/subscription_status'</span></em><a class="headerlink" href="#app.config.DeploymentConfig.STRIPE_SUBSCRIPTION_STATUS_CLAIM" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the access token claim containing the user’s stripe subscription status.
See <a class="reference external" href="https://stripe.com/docs/api/subscriptions/object#subscription_object-status">https://stripe.com/docs/api/subscriptions/object#subscription_object-status</a> for a list
of possible values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.DeploymentConfig.config_table">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">config_table</span></span><a class="headerlink" href="#app.config.DeploymentConfig.config_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine which config database table fallback configuration values should be read.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>&#64;see app.constants.config_table_names</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.DeploymentTestConfig">
<span class="sig-prename descclassname"><span class="pre">app.config.</span></span><span class="sig-name descname"><span class="pre">DeploymentTestConfig</span></span><a class="headerlink" href="#app.config.DeploymentTestConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">app.config._TestConfig.&lt;locals&gt;.TestConfig</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="app.config.LocalConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.config.</span></span><span class="sig-name descname"><span class="pre">LocalConfig</span></span><a class="headerlink" href="#app.config.LocalConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#app.config.DeploymentConfig" title="app.config.DeploymentConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">app.config.DeploymentConfig</span></code></a></p>
<p>Application configuration for applications running on local development machines.</p>
<p>Applications running locally must set CONFIG_DB_URL and POSTGRES_PASSWORD either in the
process’s execution environment or in a .env file.</p>
<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.APP_GIT_BRANCH">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">APP_GIT_BRANCH</span></span><a class="headerlink" href="#app.config.LocalConfig.APP_GIT_BRANCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.APP_GIT_COMMIT">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">APP_GIT_COMMIT</span></span><a class="headerlink" href="#app.config.LocalConfig.APP_GIT_COMMIT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.AUTH0_DOMAIN">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_DOMAIN</span></span><a class="headerlink" href="#app.config.LocalConfig.AUTH0_DOMAIN" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.AUTH0_WEBSERVER_CLIENT_ID">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_WEBSERVER_CLIENT_ID</span></span><a class="headerlink" href="#app.config.LocalConfig.AUTH0_WEBSERVER_CLIENT_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.AUTH0_WEBSERVER_CLIENT_SECRET">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AUTH0_WEBSERVER_CLIENT_SECRET</span></span><a class="headerlink" href="#app.config.LocalConfig.AUTH0_WEBSERVER_CLIENT_SECRET" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.AWS_TASKS_PER_INSTANCE">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">AWS_TASKS_PER_INSTANCE</span></span><a class="headerlink" href="#app.config.LocalConfig.AWS_TASKS_PER_INSTANCE" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.ENVIRONMENT">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ENVIRONMENT</span></span><a class="headerlink" href="#app.config.LocalConfig.ENVIRONMENT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.LocalConfig.HOST_SERVER">
<span class="sig-name descname"><span class="pre">HOST_SERVER</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'local-unknown'</span></em><a class="headerlink" href="#app.config.LocalConfig.HOST_SERVER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.LocalConfig.SENTRY_DSN">
<span class="sig-name descname"><span class="pre">SENTRY_DSN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">''</span></em><a class="headerlink" href="#app.config.LocalConfig.SENTRY_DSN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="app.config.LocalConfig.STRIPE_SECRET">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">STRIPE_SECRET</span></span><a class="headerlink" href="#app.config.LocalConfig.STRIPE_SECRET" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance attribute value.</p>
<p>This function is an instance method suitable to be passed as the first argument to the
built-in property() decorator. Were this method defined as instance methods are normally
defined, it would be clear that the config argument is actually the instance on which the
method is defined, i.e. self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – The instance on which the method is defined. Passed automatically when this
function is called using instance.method() syntax.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Either a str or an int; the value of the configuration variable for which this function</dt><dd><p>has been generated to be a getter method.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – The configuration key for which this function has been generated to be a
    getter method could be found neither in the process’s execution environment nor in
    the configuration database.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.config.LocalTestConfig">
<span class="sig-prename descclassname"><span class="pre">app.config.</span></span><span class="sig-name descname"><span class="pre">LocalTestConfig</span></span><a class="headerlink" href="#app.config.LocalTestConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">app.config._TestConfig.&lt;locals&gt;.TestConfig</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.config.getter">
<span class="sig-prename descclassname"><span class="pre">app.config.</span></span><span class="sig-name descname"><span class="pre">getter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fetch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#app.config.getter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a getter function that can be passed to the builtin property decorator.</p>
<p>This function attempts to retrieve the value associated with a configuration variable key. It
first tries to retrieve the value of the environment variable whose name matches the key. If
no environment variable is set in the process’s execution environment it may attempt to fetch
the value associated with the specified key from Fractal’s configuration database. If the key
cannot be found, a default value is returned or a KeyError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key to retrieve.</p></li>
<li><p><strong>fetch</strong> – A boolean indicating whether or not to fetch this key from the configuration
database.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>default</strong> – An optional default value to return if the key is not found. Setting implies
raising=False.</p></li>
<li><p><strong>raising</strong> – A boolean indicating whether or not to raise a KeyError if a key cannot be
found.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A getter function that retrieves the value associated with the specified key from the
process’s execution environment, optionally falling back on the configuration database.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-app.exceptions">
<span id="app-exceptions-module"></span><h2>app.exceptions module<a class="headerlink" href="#module-app.exceptions" title="Permalink to this headline">¶</a></h2>
<p>A collection of exceptions that may be raised by the Flask application.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="app.exceptions.SentryInitializationError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">app.exceptions.</span></span><span class="sig-name descname"><span class="pre">SentryInitializationError</span></span><a class="headerlink" href="#app.exceptions.SentryInitializationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

</section>
<section id="module-app.factory">
<span id="app-factory-module"></span><h2>app.factory module<a class="headerlink" href="#module-app.factory" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="app.factory.create_app">
<span class="sig-prename descclassname"><span class="pre">app.factory.</span></span><span class="sig-name descname"><span class="pre">create_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.factory.create_app" title="Permalink to this definition">¶</a></dt>
<dd><p>A Flask application factory.</p>
<p>See <a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/patterns/appfactories/?highlight=factory">https://flask.palletsprojects.com/en/1.1.x/patterns/appfactories/?highlight=factory</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>testing</strong> – A boolean indicating whether or not to configure the application for testing.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Flask application instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.factory.decode_key_callback">
<span class="sig-prename descclassname"><span class="pre">app.factory.</span></span><span class="sig-name descname"><span class="pre">decode_key_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unverified_headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_unverified_payload</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.factory.decode_key_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically determine the key to use to validate each JWT.</p>
<p>The AUTH0_DOMAIN Flask configuration variable MUST be set.</p>
<dl class="simple">
<dt>Inspiration:</dt><dd><p><a class="reference external" href="https://pyjwt.readthedocs.io/en/stable/usage.html#retrieve-rsa-signing-keys-from-a-jwks-endpoint">https://pyjwt.readthedocs.io/en/stable/usage.html#retrieve-rsa-signing-keys-from-a-jwks-endpoint</a></p>
</dd>
<dt>Specification:</dt><dd><p><a class="reference external" href="https://flask-jwt-extended.readthedocs.io/en/stable/api/#flask_jwt_extended.JWTManager.decode_key_loader">https://flask-jwt-extended.readthedocs.io/en/stable/api/#flask_jwt_extended.JWTManager.decode_key_loader</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.factory.register_blueprints">
<span class="sig-prename descclassname"><span class="pre">app.factory.</span></span><span class="sig-name descname"><span class="pre">register_blueprints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.factory.register_blueprints" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers all blueprints (endpoints) for the Flask app</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>app</strong> (<em>-</em>) – Flask object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.factory.register_commands">
<span class="sig-prename descclassname"><span class="pre">app.factory.</span></span><span class="sig-name descname"><span class="pre">register_commands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.factory.register_commands" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers all blueprints (cli commands) for the Flask app</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>app</strong> (<em>-</em>) – Flask object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.factory.register_handlers">
<span class="sig-prename descclassname"><span class="pre">app.factory.</span></span><span class="sig-name descname"><span class="pre">register_handlers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">flask.app.Flask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.factory.register_handlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Register all Flask app handlers. This should SHOULD NOT include endpoint definitions, which
happens via blueprints in <cite>register_blueprints</cite>. These handlers should be other functions
that need to be decorated by a Flask app (such as app.before_request(func)).</p>
</dd></dl>

</section>
<section id="module-app.flask_handlers">
<span id="app-flask-handlers-module"></span><h2>app.flask_handlers module<a class="headerlink" href="#module-app.flask_handlers" title="Permalink to this headline">¶</a></h2>
<p>Install handlers for the flask app. Specifically:
- can_process_requests_handler</p>
<dl class="py function">
<dt class="sig sig-object py" id="app.flask_handlers.can_process_requests">
<span class="sig-prename descclassname"><span class="pre">app.flask_handlers.</span></span><span class="sig-name descname"><span class="pre">can_process_requests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#app.flask_handlers.can_process_requests" title="Permalink to this definition">¶</a></dt>
<dd><p>Get state of _WEB_REQUESTS_ENABLED in thread-safe manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if and only if _WEB_REQUESTS_ENABLED is True. False if _WEB_REQUESTS_ENABLED is False
or acquiring lock failed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.flask_handlers.can_process_requests_handler">
<span class="sig-prename descclassname"><span class="pre">app.flask_handlers.</span></span><span class="sig-name descname"><span class="pre">can_process_requests_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">flask.app.Flask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.flask_handlers.can_process_requests_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a before_request handler to the Flask app <cite>app</cite>. Makes
sure web requests are enabled before processing them.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.flask_handlers.set_web_requests_status">
<span class="sig-prename descclassname"><span class="pre">app.flask_handlers.</span></span><span class="sig-name descname"><span class="pre">set_web_requests_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enabled</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#app.flask_handlers.set_web_requests_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set state of _WEB_REQUESTS_ENABLED. If True, web requests allowed. If False, all are
rejected with RESOURCE_UNAVAILABLE status code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>enabled</strong> – Desired state of _WEB_REQUESTS_ENABLED.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if and only if _WEB_REQUESTS_ENABLED was properly set to the given parameter <cite>enabled</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-app.models">
<span id="app-models-module"></span><h2>app.models module<a class="headerlink" href="#module-app.models" title="Permalink to this headline">¶</a></h2>
<p>SQLAlchemy models</p>
<p>In this module, we define Python models that represent tables in our PostgreSQL database. Each
model’s attributes are automatically loaded from database column names when we call
<code class="docutils literal notranslate"><span class="pre">DeferredReflection.prepare()</span></code> in <code class="docutils literal notranslate"><span class="pre">app/factory.py</span></code>.</p>
<p>Note that SQLAlchemy is unable to reflect primary key constraints from views automatically. For
models representing SQL views (e.g. <a class="reference internal" href="#app.models.LingeringInstances" title="app.models.LingeringInstances"><code class="xref py py-class docutils literal notranslate"><span class="pre">LingeringInstances</span></code></a>), the attribute representing the
primary key column must be defined explicitly.</p>
<dl class="py class">
<dt class="sig sig-object py" id="app.models.InstanceInfo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.models.</span></span><span class="sig-name descname"><span class="pre">InstanceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.models.InstanceInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.extensions.DeferredReflection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.decl_api.Model</span></code></p>
<p>General information about our EC2 instances</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.instance_name">
<span class="sig-name descname"><span class="pre">instance_name</span></span><a class="headerlink" href="#app.models.InstanceInfo.instance_name" title="Permalink to this definition">¶</a></dt>
<dd><p>what is the instance called?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.cloud_provider_id">
<span class="sig-name descname"><span class="pre">cloud_provider_id</span></span><a class="headerlink" href="#app.models.InstanceInfo.cloud_provider_id" title="Permalink to this definition">¶</a></dt>
<dd><p>instance id from AWS console</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.location">
<span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#app.models.InstanceInfo.location" title="Permalink to this definition">¶</a></dt>
<dd><p>AWS region (i.e. us-east-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.instance_type">
<span class="sig-name descname"><span class="pre">instance_type</span></span><a class="headerlink" href="#app.models.InstanceInfo.instance_type" title="Permalink to this definition">¶</a></dt>
<dd><p>what hardware is the instance running on?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.ip">
<span class="sig-name descname"><span class="pre">ip</span></span><a class="headerlink" href="#app.models.InstanceInfo.ip" title="Permalink to this definition">¶</a></dt>
<dd><p>the instance’s public IP</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.nanocpus_remaining">
<span class="sig-name descname"><span class="pre">nanocpus_remaining</span></span><a class="headerlink" href="#app.models.InstanceInfo.nanocpus_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU that isn’t in use</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.gpu_vram_remaining_kb">
<span class="sig-name descname"><span class="pre">gpu_vram_remaining_kb</span></span><a class="headerlink" href="#app.models.InstanceInfo.gpu_vram_remaining_kb" title="Permalink to this definition">¶</a></dt>
<dd><p>GPU that isn’t in use</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.memory_remaining_kb">
<span class="sig-name descname"><span class="pre">memory_remaining_kb</span></span><a class="headerlink" href="#app.models.InstanceInfo.memory_remaining_kb" title="Permalink to this definition">¶</a></dt>
<dd><p>RAM not in use</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.mandelbox_capacity">
<span class="sig-name descname"><span class="pre">mandelbox_capacity</span></span><a class="headerlink" href="#app.models.InstanceInfo.mandelbox_capacity" title="Permalink to this definition">¶</a></dt>
<dd><p>how many mandelboxes can run at once?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.last_updated_utc_unix_ms">
<span class="sig-name descname"><span class="pre">last_updated_utc_unix_ms</span></span><a class="headerlink" href="#app.models.InstanceInfo.last_updated_utc_unix_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>when did this instance last tell us it existed?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.creation_time_utc_unix_ms">
<span class="sig-name descname"><span class="pre">creation_time_utc_unix_ms</span></span><a class="headerlink" href="#app.models.InstanceInfo.creation_time_utc_unix_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>When was this instance created?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.aws_ami_id">
<span class="sig-name descname"><span class="pre">aws_ami_id</span></span><a class="headerlink" href="#app.models.InstanceInfo.aws_ami_id" title="Permalink to this definition">¶</a></dt>
<dd><p>what image is this machine based on?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.status">
<span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#app.models.InstanceInfo.status" title="Permalink to this definition">¶</a></dt>
<dd><p>either PRE_CONNECTION, ACTIVE, HOST_SERVICE_UNRESPONSIVE or DRAINING</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstanceInfo.commit_hash">
<span class="sig-name descname"><span class="pre">commit_hash</span></span><a class="headerlink" href="#app.models.InstanceInfo.commit_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>what commit hash of our infrastructure is this machine running?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.models.</span></span><span class="sig-name descname"><span class="pre">InstancesWithRoomForMandelboxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.extensions.DeferredReflection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.decl_api.Model</span></code></p>
<p>A map linking instance information to general mandelbox information
i.e. ‘how many mandelboxes are running on this instance’,
‘how many can be’, etc.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.location">
<span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.location" title="Permalink to this definition">¶</a></dt>
<dd><p>where is the instance?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.status">
<span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.status" title="Permalink to this definition">¶</a></dt>
<dd><p>what’s the instance’s status?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.ami_id">
<span class="sig-name descname"><span class="pre">ami_id</span></span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.ami_id" title="Permalink to this definition">¶</a></dt>
<dd><p>What image is the instance running?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.mandelbox_capacity">
<span class="sig-name descname"><span class="pre">mandelbox_capacity</span></span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.mandelbox_capacity" title="Permalink to this definition">¶</a></dt>
<dd><p>How many mandelboxes can the instance have?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.num_running_mandelboxes">
<span class="sig-name descname"><span class="pre">num_running_mandelboxes</span></span><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.num_running_mandelboxes" title="Permalink to this definition">¶</a></dt>
<dd><p>and how many does it have?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.InstancesWithRoomForMandelboxes.instance_name">
<span class="sig-name descname"><span class="pre">instance_name</span></span><em class="property"> <span class="pre">=</span> <span class="pre">Column('instance_name',</span> <span class="pre">String(),</span> <span class="pre">table=&lt;instances_with_room_for_mandelboxes&gt;,</span> <span class="pre">primary_key=True,</span> <span class="pre">nullable=False)</span></em><a class="headerlink" href="#app.models.InstancesWithRoomForMandelboxes.instance_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A string that uniquely identifies the instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="app.models.LingeringInstances">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.models.</span></span><span class="sig-name descname"><span class="pre">LingeringInstances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.models.LingeringInstances" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.extensions.DeferredReflection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.decl_api.Model</span></code></p>
<p>A view detailing which instances haven’t updated recently so we can manually
drain them.
Specifically, it’s all instances that are listed as either  active or preconnection,
but that have not updated their status in the db for the specified period of time:
2 min for running instances, 15 for preconnected instances</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.LingeringInstances.cloud_provider_id">
<span class="sig-name descname"><span class="pre">cloud_provider_id</span></span><a class="headerlink" href="#app.models.LingeringInstances.cloud_provider_id" title="Permalink to this definition">¶</a></dt>
<dd><p>What’s it called on AWS?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.LingeringInstances.status">
<span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#app.models.LingeringInstances.status" title="Permalink to this definition">¶</a></dt>
<dd><p>What’s it’s most recent status??</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.LingeringInstances.instance_name">
<span class="sig-name descname"><span class="pre">instance_name</span></span><em class="property"> <span class="pre">=</span> <span class="pre">Column('instance_name',</span> <span class="pre">String(),</span> <span class="pre">table=&lt;lingering_instances&gt;,</span> <span class="pre">primary_key=True,</span> <span class="pre">nullable=False)</span></em><a class="headerlink" href="#app.models.LingeringInstances.instance_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A string that uniquely identifies the instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="app.models.MandelboxInfo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.models.</span></span><span class="sig-name descname"><span class="pre">MandelboxInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.models.MandelboxInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.extensions.DeferredReflection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.decl_api.Model</span></code></p>
<p>Information about individual mandelboxes, namely
who’s running them and where they’re running.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.MandelboxInfo.mandelbox_id">
<span class="sig-name descname"><span class="pre">mandelbox_id</span></span><a class="headerlink" href="#app.models.MandelboxInfo.mandelbox_id" title="Permalink to this definition">¶</a></dt>
<dd><p>which mandelbox is this?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.MandelboxInfo.instance_name">
<span class="sig-name descname"><span class="pre">instance_name</span></span><a class="headerlink" href="#app.models.MandelboxInfo.instance_name" title="Permalink to this definition">¶</a></dt>
<dd><p>the instance the mandelbox lives on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.MandelboxInfo.user_id">
<span class="sig-name descname"><span class="pre">user_id</span></span><a class="headerlink" href="#app.models.MandelboxInfo.user_id" title="Permalink to this definition">¶</a></dt>
<dd><p>who requested it?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.MandelboxInfo.status">
<span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#app.models.MandelboxInfo.status" title="Permalink to this definition">¶</a></dt>
<dd><p>is it running?</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="app.models.RegionToAmi">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.models.</span></span><span class="sig-name descname"><span class="pre">RegionToAmi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.models.RegionToAmi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.extensions.DeferredReflection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.decl_api.Model</span></code></p>
<p>This class represents the region_to_ami table in cloud
it maps region names to the AMIs which should be used
for instances in that region</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.RegionToAmi.region_name">
<span class="sig-name descname"><span class="pre">region_name</span></span><a class="headerlink" href="#app.models.RegionToAmi.region_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the region to which the AMI corresponds as a string.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.RegionToAmi.ami_id">
<span class="sig-name descname"><span class="pre">ami_id</span></span><a class="headerlink" href="#app.models.RegionToAmi.ami_id" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing the AMI ID of the latest AMI provisioned in the region
corresponding to this row.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.RegionToAmi.client_commit_hash">
<span class="sig-name descname"><span class="pre">client_commit_hash</span></span><a class="headerlink" href="#app.models.RegionToAmi.client_commit_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing the commit hash for the client.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.RegionToAmi.ami_active">
<span class="sig-name descname"><span class="pre">ami_active</span></span><a class="headerlink" href="#app.models.RegionToAmi.ami_active" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean that will be marked true if this AMI corresponds to
an active versions of the client app’.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.models.RegionToAmi.protected_from_scale_down">
<span class="sig-name descname"><span class="pre">protected_from_scale_down</span></span><a class="headerlink" href="#app.models.RegionToAmi.protected_from_scale_down" title="Permalink to this definition">¶</a></dt>
<dd><p>A bool indicating whether the AMI is currently having an initial
buffer spun up for it</p>
</dd></dl>

<dl class="simple">
<dt>Constraints:</dt><dd><dl class="simple">
<dt>Unique:</dt><dd><p>_region_name_ami_id_unique_constraint: AMIs are expected to be unique per region
and most likely global too.
But didn’t find any reference to back that up, so including a constraint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-app.sentry">
<span id="app-sentry-module"></span><h2>app.sentry module<a class="headerlink" href="#module-app.sentry" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="app.sentry.init_and_ensure_sentry_connection">
<span class="sig-prename descclassname"><span class="pre">app.sentry.</span></span><span class="sig-name descname"><span class="pre">init_and_ensure_sentry_connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentry_dsn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.sentry.init_and_ensure_sentry_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialized sentry with Flask integration as well as the default
integrations. Also makes sure initialization succeeds. We do this by logging
a test message at the least serious level (debug). According to the docs and
manual experimentation, the return is None if and only if something went wrong. Otherwise,
the return is the ID of the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – A valid value from app.constants.env_names</p></li>
<li><p><strong>sentry_dsn</strong> – Acquired from SENTRY_DSN env var. Points to external sentry resource.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Errors out if the client is not initialized correctly.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-app.signals">
<span id="app-signals-module"></span><h2>app.signals module<a class="headerlink" href="#module-app.signals" title="Permalink to this headline">¶</a></h2>
<p>This modules contains handlers for the following signals:
1. SIGTERM. Sent by Heroku before dyno restart. See
<a class="reference external" href="https://www.notion.so/tryfractal/Resolving-Heroku-Dyno-Restart-db63f4cbb9bd49a1a1fdab7aeb1f77e6">https://www.notion.so/tryfractal/Resolving-Heroku-Dyno-Restart-db63f4cbb9bd49a1a1fdab7aeb1f77e6</a>
for more details on when this happens and how we are solving it.</p>
<dl class="py class">
<dt class="sig sig-object py" id="app.signals.WebSignalHandler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.signals.</span></span><span class="sig-name descname"><span class="pre">WebSignalHandler</span></span><a class="headerlink" href="#app.signals.WebSignalHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Handles signals for the web dyno. Specifically:
- SIGTERM (<cite>handle_sigterm</cite>)</p>
<p>Initialize in webserver with:
&gt;&gt;&gt; WebSignalHandler() # signals are now handled</p>
<dl class="py method">
<dt class="sig sig-object py" id="app.signals.WebSignalHandler.handle_sigterm">
<span class="sig-name descname"><span class="pre">handle_sigterm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.signals.WebSignalHandler.handle_sigterm" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles SIGTERM, which is sent by Heroku on various conditions outlined here:
<a class="reference external" href="https://www.notion.so/tryfractal/Resolving-Heroku-Dyno-Restart-db63f4cbb9bd49a1a1fdab7aeb1f77e6">https://www.notion.so/tryfractal/Resolving-Heroku-Dyno-Restart-db63f4cbb9bd49a1a1fdab7aeb1f77e6</a></p>
<p>SIGKILL follows 30 seconds from now, so this is our chance to clean-up resources cleanly.
Specifically, we do the following:
1. Flip a flag to stop incoming webserver requests, thereby making sure a webserver request
is not interrupted. We don’t kill webserver now because a web request might be ongoing.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-app.validation">
<span id="app-validation-module"></span><h2>app.validation module<a class="headerlink" href="#module-app.validation" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="app.validation.MandelboxAssignBody">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">app.validation.</span></span><span class="sig-name descname"><span class="pre">MandelboxAssignBody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_commit_hash</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#app.validation.MandelboxAssignBody" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="app.validation.MandelboxAssignBody.client_commit_hash">
<span class="sig-name descname"><span class="pre">client_commit_hash</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#app.validation.MandelboxAssignBody.client_commit_hash" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="app.validation.MandelboxAssignBody.region">
<span class="sig-name descname"><span class="pre">region</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#app.validation.MandelboxAssignBody.region" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-app">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-app" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="app.fractal_pre_process">
<span class="sig-prename descclassname"><span class="pre">app.</span></span><span class="sig-name descname"><span class="pre">fractal_pre_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view_func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">app._F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">app._F</span></span></span><a class="headerlink" href="#app.fractal_pre_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator bundling other decorators that should be set on all endpoints.</p>
<p>See:
- parse_request
- log_request</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.log_request">
<span class="sig-prename descclassname"><span class="pre">app.</span></span><span class="sig-name descname"><span class="pre">log_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view_func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">app._F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">app._F</span></span></span><a class="headerlink" href="#app.log_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Log information about the request, such as the method, URL, and body. This will no-op
if the logging level is set below INFO.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="app.parse_request">
<span class="sig-prename descclassname"><span class="pre">app.</span></span><span class="sig-name descname"><span class="pre">parse_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view_func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">app._F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">app._F</span></span></span><a class="headerlink" href="#app.parse_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the incoming request and provide view_func with the following kwargs:
- body (if POST request, the JSON parsed data)
- recieved_from
- webserver_url</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Fractal Webserver</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="responsibilities.html">Webserver Responsibilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="stripe.html">Stripe Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Other Services</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Module Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">app package</a></li>
<li class="toctree-l2"><a class="reference internal" href="auth0.html">auth0</a></li>
<li class="toctree-l2"><a class="reference internal" href="payments.html">Payments</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">Module Documentation</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">Module Documentation</a></li>
      <li>Next: <a href="app.constants.html" title="next chapter">app.constants package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Fractal Computers, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/app.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>