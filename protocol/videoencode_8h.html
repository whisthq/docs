<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fractal Protocol: fractal/video/videoencode.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fractal Protocol
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('videoencode_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">videoencode.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the code to create and destroy Encoders and use.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="fractal_8h_source.html">fractal/core/fractal.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="nvidia__encode_8h_source.html">nvidia_encode.h</a>&quot;</code><br />
</div>
<p><a href="videoencode_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVideoEncoder.html">VideoEncoder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct for handling ffmpeg encoding of video frames. Set to a dummy struct if we are using NVidia's SDK, which both captures and encodes frames. If software encoding, the codec and context determine the properties of the output frames, and scaling is done using the filter_graph. Frames encoded on the GPU are stored in hw_frame, while frames encoded on the CPU are stored in sw_frame.  <a href="structVideoEncoder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a70988121b77d11b511a2bd2fe701d665"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a70988121b77d11b511a2bd2fe701d665">MAX_ENCODER_PACKETS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a70988121b77d11b511a2bd2fe701d665"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aaf20c160de785dcebb9bdc14eec0f258"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structVideoEncoder.html">VideoEncoder</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#aaf20c160de785dcebb9bdc14eec0f258">VideoEncoder</a></td></tr>
<tr class="memdesc:aaf20c160de785dcebb9bdc14eec0f258"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct for handling ffmpeg encoding of video frames. Set to a dummy struct if we are using NVidia's SDK, which both captures and encodes frames. If software encoding, the codec and context determine the properties of the output frames, and scaling is done using the filter_graph. Frames encoded on the GPU are stored in hw_frame, while frames encoded on the CPU are stored in sw_frame.  <a href="videoencode_8h.html#aaf20c160de785dcebb9bdc14eec0f258">More...</a><br /></td></tr>
<tr class="separator:aaf20c160de785dcebb9bdc14eec0f258"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac8fa01e9eea92339d1c54398ad7c202c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#ac8fa01e9eea92339d1c54398ad7c202c">create_video_encoder</a> (int in_width, int in_height, int out_width, int out_height, int bitrate, <a class="el" href="fractal_8h.html#a03b4b6ae5fb82af68d46aaea3d3e4d79">CodecType</a> codec_type)</td></tr>
<tr class="memdesc:ac8fa01e9eea92339d1c54398ad7c202c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will create a new encoder.  <a href="videoencode_8h.html#ac8fa01e9eea92339d1c54398ad7c202c">More...</a><br /></td></tr>
<tr class="separator:ac8fa01e9eea92339d1c54398ad7c202c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea4ed5fa6c1ede5ab8efbcca4ca05c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#aeea4ed5fa6c1ede5ab8efbcca4ca05c5">video_encoder_frame_intake</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder, void *rgb_pixels, int pitch)</td></tr>
<tr class="memdesc:aeea4ed5fa6c1ede5ab8efbcca4ca05c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put the input data into a software frame, and upload to a hardware frame if applicable.  <a href="videoencode_8h.html#aeea4ed5fa6c1ede5ab8efbcca4ca05c5">More...</a><br /></td></tr>
<tr class="separator:aeea4ed5fa6c1ede5ab8efbcca4ca05c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444edd5dc4cb990b7441ba96964936fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a444edd5dc4cb990b7441ba96964936fa">video_encoder_encode</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder)</td></tr>
<tr class="memdesc:a444edd5dc4cb990b7441ba96964936fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode the frame in <code>encoder-&gt;sw_frame</code> or <code>encoder-&gt;hw_frame</code>. The encoded packet(s) are stored in <code>encoder-&gt;packets</code>, and the size of the buffer necessary to store them is stored in <code>encoder-&gt;encoded_frame_size</code>  <a href="videoencode_8h.html#a444edd5dc4cb990b7441ba96964936fa">More...</a><br /></td></tr>
<tr class="separator:a444edd5dc4cb990b7441ba96964936fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fef784bbabb8d61c9c13f60e674b3ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a2fef784bbabb8d61c9c13f60e674b3ca">video_encoder_write_buffer</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder, int *buf)</td></tr>
<tr class="memdesc:a2fef784bbabb8d61c9c13f60e674b3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the data from the encoded packet(s) in <code>encoder-&gt;packets</code> to a buffer, along with header information specifying the size of each packet.  <a href="videoencode_8h.html#a2fef784bbabb8d61c9c13f60e674b3ca">More...</a><br /></td></tr>
<tr class="separator:a2fef784bbabb8d61c9c13f60e674b3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad77b802583b571a3de0d17c5d6393655"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#ad77b802583b571a3de0d17c5d6393655">reconfigure_encoder</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder, int width, int height, int bitrate, <a class="el" href="fractal_8h.html#a03b4b6ae5fb82af68d46aaea3d3e4d79">CodecType</a> codec)</td></tr>
<tr class="memdesc:ad77b802583b571a3de0d17c5d6393655"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconfigure the encoder using new parameters.  <a href="videoencode_8h.html#ad77b802583b571a3de0d17c5d6393655">More...</a><br /></td></tr>
<tr class="separator:ad77b802583b571a3de0d17c5d6393655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d76272235619a7657b984487f1412a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a22d76272235619a7657b984487f1412a">video_encoder_set_iframe</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder)</td></tr>
<tr class="memdesc:a22d76272235619a7657b984487f1412a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the next frame to be an IDR-frame, with SPS/PPS headers included as well.  <a href="videoencode_8h.html#a22d76272235619a7657b984487f1412a">More...</a><br /></td></tr>
<tr class="separator:a22d76272235619a7657b984487f1412a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63794a609f997d8a1cc1201685362939"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a63794a609f997d8a1cc1201685362939">video_encoder_unset_iframe</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder)</td></tr>
<tr class="memdesc:a63794a609f997d8a1cc1201685362939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow the next frame to be either an I-frame or not an i-frame.  <a href="videoencode_8h.html#a63794a609f997d8a1cc1201685362939">More...</a><br /></td></tr>
<tr class="separator:a63794a609f997d8a1cc1201685362939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0817add564fea3dbb260a90cef9132"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="videoencode_8h.html#a7f0817add564fea3dbb260a90cef9132">destroy_video_encoder</a> (<a class="el" href="structVideoEncoder.html">VideoEncoder</a> *encoder)</td></tr>
<tr class="memdesc:a7f0817add564fea3dbb260a90cef9132"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy encoder.  <a href="videoencode_8h.html#a7f0817add564fea3dbb260a90cef9132">More...</a><br /></td></tr>
<tr class="separator:a7f0817add564fea3dbb260a90cef9132"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the code to create and destroy Encoders and use. </p>
<p>Copyright Fractal Computers, Inc. 2021</p>
<h1><a class="anchor" id="autotoc_md221"></a>
them to encode captured screens.</h1>
<h1><a class="anchor" id="autotoc_md222"></a>
Usage</h1>
<p>Video is encoded to H264 via either a hardware encoder (currently, we use NVidia GPUs, so we use NVENC) or a software encoder. H265 is also supported but not currently used. Since NVidia allows us to both capture and encode the screen, most of the functions will be called in <a class="el" href="server_2main_8c.html" title="This file contains the main code that runs a Fractal server on a.">server/main.c</a> with an empty dummy encoder. For encoders, create an H264 encoder via create_video_encode, and use it to encode frames via video_encoder_encode. Write the encoded output via video_encoder_write_buffer, and when finished, destroy the encoder using destroy_video_encoder. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a70988121b77d11b511a2bd2fe701d665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70988121b77d11b511a2bd2fe701d665">&#9670;&nbsp;</a></span>MAX_ENCODER_PACKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ENCODER_PACKETS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aaf20c160de785dcebb9bdc14eec0f258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf20c160de785dcebb9bdc14eec0f258">&#9670;&nbsp;</a></span>VideoEncoder</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structVideoEncoder.html">VideoEncoder</a> <a class="el" href="structVideoEncoder.html">VideoEncoder</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Struct for handling ffmpeg encoding of video frames. Set to a dummy struct if we are using NVidia's SDK, which both captures and encodes frames. If software encoding, the codec and context determine the properties of the output frames, and scaling is done using the filter_graph. Frames encoded on the GPU are stored in hw_frame, while frames encoded on the CPU are stored in sw_frame. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac8fa01e9eea92339d1c54398ad7c202c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fa01e9eea92339d1c54398ad7c202c">&#9670;&nbsp;</a></span>create_video_encoder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structVideoEncoder.html">VideoEncoder</a>* create_video_encoder </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>out_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>out_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fractal_8h.html#a03b4b6ae5fb82af68d46aaea3d3e4d79">CodecType</a>&#160;</td>
          <td class="paramname"><em>codec_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Will create a new encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in_width</td><td>Width of the frames that the encoder must intake </td></tr>
    <tr><td class="paramname">in_height</td><td>Height of the frames that the encoder must intake </td></tr>
    <tr><td class="paramname">out_width</td><td>Width of the frames that the encoder must output </td></tr>
    <tr><td class="paramname">out_height</td><td>Height of the frames that the encoder must output </td></tr>
    <tr><td class="paramname">bitrate</td><td>The number of bits per second that this encoder will encode to </td></tr>
    <tr><td class="paramname">codec_type</td><td>Which codec type (h264 or h265) to use</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The newly created encoder </dd></dl>

</div>
</div>
<a id="a7f0817add564fea3dbb260a90cef9132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0817add564fea3dbb260a90cef9132">&#9670;&nbsp;</a></span>destroy_video_encoder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_video_encoder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>Encoder to be destroyed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad77b802583b571a3de0d17c5d6393655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad77b802583b571a3de0d17c5d6393655">&#9670;&nbsp;</a></span>reconfigure_encoder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool reconfigure_encoder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fractal_8h.html#a03b4b6ae5fb82af68d46aaea3d3e4d79">CodecType</a>&#160;</td>
          <td class="paramname"><em>codec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconfigure the encoder using new parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>The encoder to be updated </td></tr>
    <tr><td class="paramname">width</td><td>The new width </td></tr>
    <tr><td class="paramname">height</td><td>The new height </td></tr>
    <tr><td class="paramname">bitrate</td><td>The new bitrate </td></tr>
    <tr><td class="paramname">codec</td><td>The new codec</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the encoder was successfully reconfigured, -1 if no reconfiguration was possible </dd></dl>

</div>
</div>
<a id="a444edd5dc4cb990b7441ba96964936fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444edd5dc4cb990b7441ba96964936fa">&#9670;&nbsp;</a></span>video_encoder_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int video_encoder_encode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode the frame in <code>encoder-&gt;sw_frame</code> or <code>encoder-&gt;hw_frame</code>. The encoded packet(s) are stored in <code>encoder-&gt;packets</code>, and the size of the buffer necessary to store them is stored in <code>encoder-&gt;encoded_frame_size</code> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>The encoder to use</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, else -1 </dd></dl>

</div>
</div>
<a id="aeea4ed5fa6c1ede5ab8efbcca4ca05c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeea4ed5fa6c1ede5ab8efbcca4ca05c5">&#9670;&nbsp;</a></span>video_encoder_frame_intake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int video_encoder_frame_intake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>rgb_pixels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pitch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put the input data into a software frame, and upload to a hardware frame if applicable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>The encoder to use </td></tr>
    <tr><td class="paramname">rgb_pixels</td><td>The frame to be in encoded </td></tr>
    <tr><td class="paramname">pitch</td><td>The number of bytes per line</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, else -1 </dd></dl>

</div>
</div>
<a id="a22d76272235619a7657b984487f1412a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d76272235619a7657b984487f1412a">&#9670;&nbsp;</a></span>video_encoder_set_iframe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void video_encoder_set_iframe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the next frame to be an IDR-frame, with SPS/PPS headers included as well. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>Encoder to be updated </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a63794a609f997d8a1cc1201685362939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63794a609f997d8a1cc1201685362939">&#9670;&nbsp;</a></span>video_encoder_unset_iframe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void video_encoder_unset_iframe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allow the next frame to be either an I-frame or not an i-frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>Encoder to be updated </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2fef784bbabb8d61c9c13f60e674b3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fef784bbabb8d61c9c13f60e674b3ca">&#9670;&nbsp;</a></span>video_encoder_write_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void video_encoder_write_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVideoEncoder.html">VideoEncoder</a> *&#160;</td>
          <td class="paramname"><em>encoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the data from the encoded packet(s) in <code>encoder-&gt;packets</code> to a buffer, along with header information specifying the size of each packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encoder</td><td>The encoder with stored encoded packet(s) </td></tr>
    <tr><td class="paramname">buf</td><td>A pointer to an allocated buffer of size at least <code>encoder-&gt;encoded_frame_size</code> into which to copy the data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2993051f07ff2cebc55eadc6068be547.html">fractal</a></li><li class="navelem"><a class="el" href="dir_1f883672603d7d4f5b9de53c12fbfed0.html">video</a></li><li class="navelem"><a class="el" href="videoencode_8h.html">videoencode.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
