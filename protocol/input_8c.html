<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Whist Protocol: whist/input/input.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Whist Protocol
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('input_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">input.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Copyright (c) 2021-2022 Whist Technologies, Inc.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="os__utils_8h_source.html">whist/utils/os_utils.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="input__driver_8h_source.html">input_driver.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="keyboard__mapping_8h_source.html">keyboard_mapping.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acaf86ea08826ebef87866ae548288a21"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#acaf86ea08826ebef87866ae548288a21">KeyUp</a>(input_device,  whist_keycode)&#160;&#160;&#160;<a class="el" href="xtest__input__driver_8c.html#ae20354ac9fa2cbeac2a1067ef9f79b06">emit_key_event</a>(input_device, whist_keycode, 0)</td></tr>
<tr class="separator:acaf86ea08826ebef87866ae548288a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27c4518fbdddd4fff00490ee954359d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a27c4518fbdddd4fff00490ee954359d5">KeyDown</a>(input_device,  whist_keycode)&#160;&#160;&#160;<a class="el" href="xtest__input__driver_8c.html#ae20354ac9fa2cbeac2a1067ef9f79b06">emit_key_event</a>(input_device, whist_keycode, 1)</td></tr>
<tr class="separator:a27c4518fbdddd4fff00490ee954359d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acd8b658314de05df828b42e6f7bf4b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#acd8b658314de05df828b42e6f7bf4b63">reset_input</a> (<a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4">WhistOSType</a> os_type)</td></tr>
<tr class="memdesc:acd8b658314de05df828b42e6f7bf4b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the input system.  <a href="input_8c.html#acd8b658314de05df828b42e6f7bf4b63">More...</a><br /></td></tr>
<tr class="separator:acd8b658314de05df828b42e6f7bf4b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7c52f6a54afd0f516d4070bc92be6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a3c7c52f6a54afd0f516d4070bc92be6c">update_keyboard_state</a> (<a class="el" href="structInputDevice.html">InputDevice</a> *input_device, <a class="el" href="structWhistClientMessage.html">WhistClientMessage</a> *fcmsg)</td></tr>
<tr class="memdesc:a3c7c52f6a54afd0f516d4070bc92be6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the keyboard state on the server to match the client's.  <a href="input_8c.html#a3c7c52f6a54afd0f516d4070bc92be6c">More...</a><br /></td></tr>
<tr class="separator:a3c7c52f6a54afd0f516d4070bc92be6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8488d358a602273c7b7f96ad01e8c886"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a8488d358a602273c7b7f96ad01e8c886">replay_user_input</a> (<a class="el" href="structInputDevice.html">InputDevice</a> *input_device, <a class="el" href="structWhistClientMessage.html">WhistClientMessage</a> *fcmsg)</td></tr>
<tr class="memdesc:a8488d358a602273c7b7f96ad01e8c886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replayed a received user action on a server, by sending it to the OS.  <a href="input_8c.html#a8488d358a602273c7b7f96ad01e8c886">More...</a><br /></td></tr>
<tr class="separator:a8488d358a602273c7b7f96ad01e8c886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6a54738e93c117f2b412775dfba8c8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#afa6a54738e93c117f2b412775dfba8c8">input_keycodes</a> (<a class="el" href="structInputDevice.html">InputDevice</a> *input_device, <a class="el" href="whist_8h.html#aad1832f9d718bfd4d4e414729ea4369b">WhistKeycode</a> *keycodes, size_t count)</td></tr>
<tr class="memdesc:afa6a54738e93c117f2b412775dfba8c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the keyboard state on the server to match the client's.  <a href="input_8c.html#afa6a54738e93c117f2b412775dfba8c8">More...</a><br /></td></tr>
<tr class="separator:afa6a54738e93c117f2b412775dfba8c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad7febba9db49c6ef29d4bfc0b011086f"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#ad7febba9db49c6ef29d4bfc0b011086f">last_input_fcmsg_id</a> = 0</td></tr>
<tr class="separator:ad7febba9db49c6ef29d4bfc0b011086f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b887b6c671588eb2b209d96e86d235c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4">WhistOSType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a3b887b6c671588eb2b209d96e86d235c">input_os_type</a> = <a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4a218fc679b8e1f15dded103a17a676cc4">WHIST_UNKNOWN_OS</a></td></tr>
<tr class="separator:a3b887b6c671588eb2b209d96e86d235c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Copyright (c) 2021-2022 Whist Technologies, Inc. </p>
<p>This file defines general input-processing functions and toggles </p>
<h1><a class="anchor" id="autotoc_md152"></a>
between Windows and Linux servers.</h1>
<h1><a class="anchor" id="autotoc_md153"></a>
Usage</h1>
<p>Toggles dynamically between input receiving on Windows or Linux Ubuntu computers. You can create an input device to receive input (keystrokes, mouse clicks, etc.) via CreateInputDevice. You can then send input to the Windows OS via ReplayUserInput, and use UpdateKeyboardState to sync keyboard state between local and remote computers (say, sync them to both have CapsLock activated). Lastly, you can input an array of keycodes using <code>InputKeycodes</code>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a27c4518fbdddd4fff00490ee954359d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27c4518fbdddd4fff00490ee954359d5">&#9670;&nbsp;</a></span>KeyDown</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KeyDown</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">input_device, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">whist_keycode&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="xtest__input__driver_8c.html#ae20354ac9fa2cbeac2a1067ef9f79b06">emit_key_event</a>(input_device, whist_keycode, 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acaf86ea08826ebef87866ae548288a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf86ea08826ebef87866ae548288a21">&#9670;&nbsp;</a></span>KeyUp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KeyUp</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">input_device, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">whist_keycode&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="xtest__input__driver_8c.html#ae20354ac9fa2cbeac2a1067ef9f79b06">emit_key_event</a>(input_device, whist_keycode, 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afa6a54738e93c117f2b412775dfba8c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa6a54738e93c117f2b412775dfba8c8">&#9670;&nbsp;</a></span>input_keycodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t input_keycodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputDevice.html">InputDevice</a> *&#160;</td>
          <td class="paramname"><em>input_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="whist_8h.html#aad1832f9d718bfd4d4e414729ea4369b">WhistKeycode</a> *&#160;</td>
          <td class="paramname"><em>keycodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the keyboard state on the server to match the client's. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_device</td><td>The initialized input device struct defining mouse and keyboard states for the user</td></tr>
    <tr><td class="paramname">keycodes</td><td>A pointer to an array of keycodes to sequentially input</td></tr>
    <tr><td class="paramname">count</td><td>The number of keycodes to read from <code>keycodes</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of keycodes successfully inputted from the array </dd></dl>

</div>
</div>
<a id="a8488d358a602273c7b7f96ad01e8c886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8488d358a602273c7b7f96ad01e8c886">&#9670;&nbsp;</a></span>replay_user_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool replay_user_input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputDevice.html">InputDevice</a> *&#160;</td>
          <td class="paramname"><em>input_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structWhistClientMessage.html">WhistClientMessage</a> *&#160;</td>
          <td class="paramname"><em>fcmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replayed a received user action on a server, by sending it to the OS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_device</td><td>The initialized input device struct defining mouse and keyboard states for the user</td></tr>
    <tr><td class="paramname">fcmsg</td><td>The Whist message packet, defining one user action event, to replay on the computer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if it replayed the event, False otherwise </dd></dl>

</div>
</div>
<a id="acd8b658314de05df828b42e6f7bf4b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8b658314de05df828b42e6f7bf4b63">&#9670;&nbsp;</a></span>reset_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4">WhistOSType</a>&#160;</td>
          <td class="paramname"><em>os_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the input system. </p>
<p>Should be used prior to every new client connection that will send inputs</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">os_type</td><td>The OS type to use for keyboard mapping </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3c7c52f6a54afd0f516d4070bc92be6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7c52f6a54afd0f516d4070bc92be6c">&#9670;&nbsp;</a></span>update_keyboard_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_keyboard_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputDevice.html">InputDevice</a> *&#160;</td>
          <td class="paramname"><em>input_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structWhistClientMessage.html">WhistClientMessage</a> *&#160;</td>
          <td class="paramname"><em>fcmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the keyboard state on the server to match the client's. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_device</td><td>The initialized input device struct defining mouse and keyboard states for the user</td></tr>
    <tr><td class="paramname">fcmsg</td><td>The Whist message packet, defining one keyboard event, to update the keyboard state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3b887b6c671588eb2b209d96e86d235c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b887b6c671588eb2b209d96e86d235c">&#9670;&nbsp;</a></span>input_os_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4">WhistOSType</a> input_os_type = <a class="el" href="whist_8h.html#a6e760c662b6b1560542cc151a2ac01b4a218fc679b8e1f15dded103a17a676cc4">WHIST_UNKNOWN_OS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7febba9db49c6ef29d4bfc0b011086f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7febba9db49c6ef29d4bfc0b011086f">&#9670;&nbsp;</a></span>last_input_fcmsg_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int last_input_fcmsg_id = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2163314886daa89b67d58b0e72b2c23f.html">whist</a></li><li class="navelem"><a class="el" href="dir_c245b961ad2279e6a24b2b9b76ed7f31.html">input</a></li><li class="navelem"><a class="el" href="input_8c.html">input.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
