<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Whist Protocol: client/ringbuffer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Whist Protocol
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ringbuffer_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ringbuffer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ringbuffer_8h_source.html">ringbuffer.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ace58ba786751c3524bcbb1bc4f8846ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#ace58ba786751c3524bcbb1bc4f8846ce">MAX_RING_BUFFER_SIZE</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:ace58ba786751c3524bcbb1bc4f8846ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fc8d91a4522aa7564405e36898140b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#ac2fc8d91a4522aa7564405e36898140b">MAX_VIDEO_PACKETS</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:ac2fc8d91a4522aa7564405e36898140b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83bbf59667cbb81c5c7d11df72ca7dfe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a83bbf59667cbb81c5c7d11df72ca7dfe">MAX_AUDIO_PACKETS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a83bbf59667cbb81c5c7d11df72ca7dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035f1eb6db73cb497f6de67cad4ade33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a035f1eb6db73cb497f6de67cad4ade33">MAX_UNORDERED_PACKETS</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a035f1eb6db73cb497f6de67cad4ade33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf06ce5e31c557cd5e3342811904c911"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#adf06ce5e31c557cd5e3342811904c911">MAX_PACKET_NACKS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:adf06ce5e31c557cd5e3342811904c911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0633d89e77a53993dd697dcfb78606"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a9b0633d89e77a53993dd697dcfb78606">MAX_NACKS_PER_CALL</a>&#160;&#160;&#160;25</td></tr>
<tr class="separator:a9b0633d89e77a53993dd697dcfb78606"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaae4a29416ec3cb8ae72b86ce57f3638"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#aaae4a29416ec3cb8ae72b86ce57f3638">reset_ring_buffer</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer)</td></tr>
<tr class="separator:aaae4a29416ec3cb8ae72b86ce57f3638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fc73c796f6b71709d750033c1b58b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a1fc73c796f6b71709d750033c1b58b63">init_frame</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, int id, int num_indices)</td></tr>
<tr class="separator:a1fc73c796f6b71709d750033c1b58b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d3111ad316a218e1f16161844501e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a9d3111ad316a218e1f16161844501e7a">allocate_frame_buffer</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, <a class="el" href="structFrameData.html">FrameData</a> *frame_data)</td></tr>
<tr class="separator:a9d3111ad316a218e1f16161844501e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c50544e0beb60fdcf23b5b30e9a34c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#ab9c50544e0beb60fdcf23b5b30e9a34c">destroy_frame_buffer</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, <a class="el" href="structFrameData.html">FrameData</a> *frame_data)</td></tr>
<tr class="separator:ab9c50544e0beb60fdcf23b5b30e9a34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac90027614c72dd29204b9f884e0a0493"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#ac90027614c72dd29204b9f884e0a0493">reset_bitrate_stat_members</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer)</td></tr>
<tr class="separator:ac90027614c72dd29204b9f884e0a0493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672f453baf215cd27bb691b95db7c205"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a672f453baf215cd27bb691b95db7c205">init_ring_buffer</a> (<a class="el" href="ringbuffer_8h.html#a3be5e6f81a17677db9e4aa98a541ba45">FrameDataType</a> type, int ring_buffer_size)</td></tr>
<tr class="memdesc:a672f453baf215cd27bb691b95db7c205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a ring buffer of the specified size and type.  <a href="ringbuffer_8c.html#a672f453baf215cd27bb691b95db7c205">More...</a><br /></td></tr>
<tr class="separator:a672f453baf215cd27bb691b95db7c205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a35ea430111d5dadd29f8b9b9d99c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFrameData.html">FrameData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a69a35ea430111d5dadd29f8b9b9d99c5">get_frame_at_id</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, int id)</td></tr>
<tr class="memdesc:a69a35ea430111d5dadd29f8b9b9d99c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrives the frame at the given ID in the ring buffer.  <a href="ringbuffer_8c.html#a69a35ea430111d5dadd29f8b9b9d99c5">More...</a><br /></td></tr>
<tr class="separator:a69a35ea430111d5dadd29f8b9b9d99c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4415bb2d50c63ca97a0eafa97964188d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a4415bb2d50c63ca97a0eafa97964188d">reset_frame</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, <a class="el" href="structFrameData.html">FrameData</a> *frame_data)</td></tr>
<tr class="memdesc:a4415bb2d50c63ca97a0eafa97964188d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the frame, both metadata and frame buffer.  <a href="ringbuffer_8c.html#a4415bb2d50c63ca97a0eafa97964188d">More...</a><br /></td></tr>
<tr class="separator:a4415bb2d50c63ca97a0eafa97964188d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc37000ecd47712d4a8cc8e83867a60d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#adc37000ecd47712d4a8cc8e83867a60d">set_rendering</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, int id)</td></tr>
<tr class="memdesc:adc37000ecd47712d4a8cc8e83867a60d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate that the frame with ID id is currently rendering, and free the frame buffer for the previously rendered frame. The ring buffer will not write to the currently rendering frame.  <a href="ringbuffer_8c.html#adc37000ecd47712d4a8cc8e83867a60d">More...</a><br /></td></tr>
<tr class="separator:adc37000ecd47712d4a8cc8e83867a60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7e1e295ea3891d8b9b342fab21db03"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a2f7e1e295ea3891d8b9b342fab21db03">receive_packet</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, <a class="el" href="structFractalPacket.html">FractalPacket</a> *packet)</td></tr>
<tr class="memdesc:a2f7e1e295ea3891d8b9b342fab21db03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a packet to the ring buffer, and initialize the corresponding frame if necessary. Also nacks for missing packets or frames.  <a href="ringbuffer_8c.html#a2f7e1e295ea3891d8b9b342fab21db03">More...</a><br /></td></tr>
<tr class="separator:a2f7e1e295ea3891d8b9b342fab21db03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06579df66400790c9af75c806b484aba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a06579df66400790c9af75c806b484aba">nack_single_packet</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, int id, int index)</td></tr>
<tr class="separator:a06579df66400790c9af75c806b484aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73e418ff63c607877e2cf30c280003b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a73e418ff63c607877e2cf30c280003b8">nack_bitarray_packets</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, int id, int start_index, <a class="el" href="structBitArray.html">BitArray</a> *bit_arr)</td></tr>
<tr class="separator:a73e418ff63c607877e2cf30c280003b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0048b36c977f38b40533fa7eea0f974c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a0048b36c977f38b40533fa7eea0f974c">nack_missing_packets_up_to_index</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, <a class="el" href="structFrameData.html">FrameData</a> *frame_data, int end_index, int max_packets_to_nack)</td></tr>
<tr class="separator:a0048b36c977f38b40533fa7eea0f974c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33faf8c99a7bcd3260eb86367ce9b7ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#a33faf8c99a7bcd3260eb86367ce9b7ad">try_nacking</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer, double <a class="el" href="client_2video_8c.html#a5120ece93dfddf5638a59e495e9c6d46">latency</a>)</td></tr>
<tr class="memdesc:a33faf8c99a7bcd3260eb86367ce9b7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">If any packets are still missing, and it's been too long, try nacking for them. Ideally, this gets called quite rapidly, it has internal timers to throttle nacks. The more rapidly the better, just need to balance CPU usage, 5-10ms should be fine.  <a href="ringbuffer_8c.html#a33faf8c99a7bcd3260eb86367ce9b7ad">More...</a><br /></td></tr>
<tr class="separator:a33faf8c99a7bcd3260eb86367ce9b7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af514843307356fd516b1a96211c9d986"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ringbuffer_8c.html#af514843307356fd516b1a96211c9d986">destroy_ring_buffer</a> (<a class="el" href="structRingBuffer.html">RingBuffer</a> *ring_buffer)</td></tr>
<tr class="memdesc:af514843307356fd516b1a96211c9d986"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the ring buffer and all its constituent frames.  <a href="ringbuffer_8c.html#af514843307356fd516b1a96211c9d986">More...</a><br /></td></tr>
<tr class="separator:af514843307356fd516b1a96211c9d986"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a83bbf59667cbb81c5c7d11df72ca7dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83bbf59667cbb81c5c7d11df72ca7dfe">&#9670;&nbsp;</a></span>MAX_AUDIO_PACKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_AUDIO_PACKETS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b0633d89e77a53993dd697dcfb78606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b0633d89e77a53993dd697dcfb78606">&#9670;&nbsp;</a></span>MAX_NACKS_PER_CALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NACKS_PER_CALL&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adf06ce5e31c557cd5e3342811904c911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf06ce5e31c557cd5e3342811904c911">&#9670;&nbsp;</a></span>MAX_PACKET_NACKS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PACKET_NACKS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ace58ba786751c3524bcbb1bc4f8846ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace58ba786751c3524bcbb1bc4f8846ce">&#9670;&nbsp;</a></span>MAX_RING_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_RING_BUFFER_SIZE&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a035f1eb6db73cb497f6de67cad4ade33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a035f1eb6db73cb497f6de67cad4ade33">&#9670;&nbsp;</a></span>MAX_UNORDERED_PACKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_UNORDERED_PACKETS&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2fc8d91a4522aa7564405e36898140b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2fc8d91a4522aa7564405e36898140b">&#9670;&nbsp;</a></span>MAX_VIDEO_PACKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_VIDEO_PACKETS&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9d3111ad316a218e1f16161844501e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d3111ad316a218e1f16161844501e7a">&#9670;&nbsp;</a></span>allocate_frame_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocate_frame_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFrameData.html">FrameData</a> *&#160;</td>
          <td class="paramname"><em>frame_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab9c50544e0beb60fdcf23b5b30e9a34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c50544e0beb60fdcf23b5b30e9a34c">&#9670;&nbsp;</a></span>destroy_frame_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_frame_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFrameData.html">FrameData</a> *&#160;</td>
          <td class="paramname"><em>frame_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af514843307356fd516b1a96211c9d986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af514843307356fd516b1a96211c9d986">&#9670;&nbsp;</a></span>destroy_ring_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_ring_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free the ring buffer and all its constituent frames. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>Ring buffer to destroy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a69a35ea430111d5dadd29f8b9b9d99c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a35ea430111d5dadd29f8b9b9d99c5">&#9670;&nbsp;</a></span>get_frame_at_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFrameData.html">FrameData</a>* get_frame_at_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrives the frame at the given ID in the ring buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>Ring buffer to access</td></tr>
    <tr><td class="paramname">id</td><td>ID of desired frame.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the <a class="el" href="structFrameData.html" title="FrameData struct containing content and metadata of encoded frames.">FrameData</a> at ID id in ring_buffer. </dd></dl>

</div>
</div>
<a id="a1fc73c796f6b71709d750033c1b58b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fc73c796f6b71709d750033c1b58b63">&#9670;&nbsp;</a></span>init_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_frame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a672f453baf215cd27bb691b95db7c205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a672f453baf215cd27bb691b95db7c205">&#9670;&nbsp;</a></span>init_ring_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structRingBuffer.html">RingBuffer</a>* init_ring_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ringbuffer_8h.html#a3be5e6f81a17677db9e4aa98a541ba45">FrameDataType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ring_buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a ring buffer of the specified size and type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Either an audio or video ring buffer.</td></tr>
    <tr><td class="paramname">ring_buffer_size</td><td>The desired size of the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the newly created ring buffer. All frames in the new ring buffer have ID -1. </dd></dl>

</div>
</div>
<a id="a73e418ff63c607877e2cf30c280003b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e418ff63c607877e2cf30c280003b8">&#9670;&nbsp;</a></span>nack_bitarray_packets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nack_bitarray_packets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBitArray.html">BitArray</a> *&#160;</td>
          <td class="paramname"><em>bit_arr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0048b36c977f38b40533fa7eea0f974c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0048b36c977f38b40533fa7eea0f974c">&#9670;&nbsp;</a></span>nack_missing_packets_up_to_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nack_missing_packets_up_to_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFrameData.html">FrameData</a> *&#160;</td>
          <td class="paramname"><em>frame_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_packets_to_nack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06579df66400790c9af75c806b484aba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06579df66400790c9af75c806b484aba">&#9670;&nbsp;</a></span>nack_single_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nack_single_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f7e1e295ea3891d8b9b342fab21db03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f7e1e295ea3891d8b9b342fab21db03">&#9670;&nbsp;</a></span>receive_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int receive_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFractalPacket.html">FractalPacket</a> *&#160;</td>
          <td class="paramname"><em>packet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a packet to the ring buffer, and initialize the corresponding frame if necessary. Also nacks for missing packets or frames. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>Ring buffer to place packet into</td></tr>
    <tr><td class="paramname">packet</td><td>An audio or video UDP packet</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="ac90027614c72dd29204b9f884e0a0493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac90027614c72dd29204b9f884e0a0493">&#9670;&nbsp;</a></span>reset_bitrate_stat_members()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_bitrate_stat_members </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4415bb2d50c63ca97a0eafa97964188d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4415bb2d50c63ca97a0eafa97964188d">&#9670;&nbsp;</a></span>reset_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_frame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFrameData.html">FrameData</a> *&#160;</td>
          <td class="paramname"><em>frame_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the frame, both metadata and frame buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>Ring buffer containing the frame. </td></tr>
    <tr><td class="paramname">frame_data</td><td>Frame to "clear" from the ring buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaae4a29416ec3cb8ae72b86ce57f3638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaae4a29416ec3cb8ae72b86ce57f3638">&#9670;&nbsp;</a></span>reset_ring_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_ring_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc37000ecd47712d4a8cc8e83867a60d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc37000ecd47712d4a8cc8e83867a60d">&#9670;&nbsp;</a></span>set_rendering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_rendering </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate that the frame with ID id is currently rendering, and free the frame buffer for the previously rendered frame. The ring buffer will not write to the currently rendering frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>Ring buffer containing the frame</td></tr>
    <tr><td class="paramname">id</td><td>ID of the frame we are currently rendering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a33faf8c99a7bcd3260eb86367ce9b7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33faf8c99a7bcd3260eb86367ce9b7ad">&#9670;&nbsp;</a></span>try_nacking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void try_nacking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRingBuffer.html">RingBuffer</a> *&#160;</td>
          <td class="paramname"><em>ring_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If any packets are still missing, and it's been too long, try nacking for them. Ideally, this gets called quite rapidly, it has internal timers to throttle nacks. The more rapidly the better, just need to balance CPU usage, 5-10ms should be fine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ring_buffer</td><td>The ring buffer to try nacking with</td></tr>
    <tr><td class="paramname">latency</td><td>The round-trip latency of the connection. Helpful with nacking logic </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_db3a54907829b36871118d03417739cd.html">client</a></li><li class="navelem"><a class="el" href="ringbuffer_8c.html">ringbuffer.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
