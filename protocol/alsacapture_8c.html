<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Whist Protocol: whist/audio/alsacapture.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Whist Protocol
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('alsacapture_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">alsacapture.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="alsacapture_8h_source.html">alsacapture.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a525780eca41b5042a3f0cdf386ab98dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a525780eca41b5042a3f0cdf386ab98dd">FREE_ALL</a>()</td></tr>
<tr class="separator:a525780eca41b5042a3f0cdf386ab98dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a85321c477a1aa1a1fd700a67a4772ff8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a85321c477a1aa1a1fd700a67a4772ff8">create_audio_device</a> ()</td></tr>
<tr class="memdesc:a85321c477a1aa1a1fd700a67a4772ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an audio device to capture audio on Windows or Linux Ubuntu.  <a href="alsacapture_8c.html#a85321c477a1aa1a1fd700a67a4772ff8">More...</a><br /></td></tr>
<tr class="separator:a85321c477a1aa1a1fd700a67a4772ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae340600cbb065245f427f7b023aeed9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#ae340600cbb065245f427f7b023aeed9b">start_audio_device</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:ae340600cbb065245f427f7b023aeed9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the audio device to start capturing audio.  <a href="alsacapture_8c.html#ae340600cbb065245f427f7b023aeed9b">More...</a><br /></td></tr>
<tr class="separator:ae340600cbb065245f427f7b023aeed9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3695593b8280bd00d1276a74480b3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a1c3695593b8280bd00d1276a74480b3f">destroy_audio_device</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:a1c3695593b8280bd00d1276a74480b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the audio device sutrct and free its memory.  <a href="alsacapture_8c.html#a1c3695593b8280bd00d1276a74480b3f">More...</a><br /></td></tr>
<tr class="separator:a1c3695593b8280bd00d1276a74480b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c9f24da51f1e5196146f90f46ad4fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#af7c9f24da51f1e5196146f90f46ad4fd">get_next_packet</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:af7c9f24da51f1e5196146f90f46ad4fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request the next packet of audio data from the captured audio stream.  <a href="alsacapture_8c.html#af7c9f24da51f1e5196146f90f46ad4fd">More...</a><br /></td></tr>
<tr class="separator:af7c9f24da51f1e5196146f90f46ad4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cce871f5f3f98735801b49f1ed1522a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a5cce871f5f3f98735801b49f1ed1522a">packet_available</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:a5cce871f5f3f98735801b49f1ed1522a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the next packet of audio data is available from the captured audio stream.  <a href="alsacapture_8c.html#a5cce871f5f3f98735801b49f1ed1522a">More...</a><br /></td></tr>
<tr class="separator:a5cce871f5f3f98735801b49f1ed1522a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad826ca249bb768bfb803992ed26dd84a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#ad826ca249bb768bfb803992ed26dd84a">get_buffer</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:ad826ca249bb768bfb803992ed26dd84a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the buffer holding the next packet of audio data from the audio stream.  <a href="alsacapture_8c.html#ad826ca249bb768bfb803992ed26dd84a">More...</a><br /></td></tr>
<tr class="separator:ad826ca249bb768bfb803992ed26dd84a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296f01acd07e025234ef09c7770aec4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a296f01acd07e025234ef09c7770aec4a">release_buffer</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:a296f01acd07e025234ef09c7770aec4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the buffer holding the next packet of audio data from the audio stream.  <a href="alsacapture_8c.html#a296f01acd07e025234ef09c7770aec4a">More...</a><br /></td></tr>
<tr class="separator:a296f01acd07e025234ef09c7770aec4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a729e6be9914233256d56176ddee16c78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="alsacapture_8c.html#a729e6be9914233256d56176ddee16c78">wait_timer</a> (<a class="el" href="structAudioDevice.html">AudioDevice</a> *audio_device)</td></tr>
<tr class="memdesc:a729e6be9914233256d56176ddee16c78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for the next packet (only on ALSA, since it is blocking, while WASAPI is not)  <a href="alsacapture_8c.html#a729e6be9914233256d56176ddee16c78">More...</a><br /></td></tr>
<tr class="separator:a729e6be9914233256d56176ddee16c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Copyright 2021 Whist Technologies, Inc.</p>
<h1><a class="anchor" id="autotoc_md106"></a>
@brief This file contains the code to capture audio on Ubuntu using ALSA.</h1>
<h1><a class="anchor" id="autotoc_md107"></a>
Usage</h1>
<p>Audio is captured as a stream. You first need to create an audio device via CreateAudioDevice. You can then start it via StartAudioDevice and it will capture all audio data it finds. It captures nothing if there is no audio playing. You can use GetNextPacket to retrieve the next packet of audio data from the stream,, and GetBuffer to grab the data. Packets will keep coming whether you grab them or not. Once you are done, you need to destroy the audio device via DestroyAudioDevice. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a525780eca41b5042a3f0cdf386ab98dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525780eca41b5042a3f0cdf386ab98dd">&#9670;&nbsp;</a></span>FREE_ALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREE_ALL</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                        \</div>
<div class="line">        snd_pcm_close(audio_device-&gt;handle); \</div>
<div class="line">        free(audio_device);                  \</div>
<div class="line">        snd_pcm_hw_params_free(params);      \</div>
<div class="line">    };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a85321c477a1aa1a1fd700a67a4772ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85321c477a1aa1a1fd700a67a4772ff8">&#9670;&nbsp;</a></span>create_audio_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAudioDevice.html">AudioDevice</a>* create_audio_device </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an audio device to capture audio on Windows or Linux Ubuntu. </p>
<dl class="section return"><dt>Returns</dt><dd>The initialized audio device struct </dd></dl>

</div>
</div>
<a id="a1c3695593b8280bd00d1276a74480b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3695593b8280bd00d1276a74480b3f">&#9670;&nbsp;</a></span>destroy_audio_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_audio_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the audio device sutrct and free its memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that gets destroyed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad826ca249bb768bfb803992ed26dd84a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad826ca249bb768bfb803992ed26dd84a">&#9670;&nbsp;</a></span>get_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the buffer holding the next packet of audio data from the audio stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that captures the audio stream </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af7c9f24da51f1e5196146f90f46ad4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c9f24da51f1e5196146f90f46ad4fd">&#9670;&nbsp;</a></span>get_next_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_next_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request the next packet of audio data from the captured audio stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that captures the audio stream </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5cce871f5f3f98735801b49f1ed1522a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cce871f5f3f98735801b49f1ed1522a">&#9670;&nbsp;</a></span>packet_available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool packet_available </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the next packet of audio data is available from the captured audio stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that captures the audio stream</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the next packet of audio data is available, else False </dd></dl>

</div>
</div>
<a id="a296f01acd07e025234ef09c7770aec4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296f01acd07e025234ef09c7770aec4a">&#9670;&nbsp;</a></span>release_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void release_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release the buffer holding the next packet of audio data from the audio stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that captures the audio stream </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae340600cbb065245f427f7b023aeed9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae340600cbb065245f427f7b023aeed9b">&#9670;&nbsp;</a></span>start_audio_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void start_audio_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the audio device to start capturing audio. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that gets started to capture audio </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a729e6be9914233256d56176ddee16c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a729e6be9914233256d56176ddee16c78">&#9670;&nbsp;</a></span>wait_timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wait_timer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDevice.html">AudioDevice</a> *&#160;</td>
          <td class="paramname"><em>audio_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for the next packet (only on ALSA, since it is blocking, while WASAPI is not) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audio_device</td><td>The audio device that captures the audio stream </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2993051f07ff2cebc55eadc6068be547.html">whist</a></li><li class="navelem"><a class="el" href="dir_f1599b8c0e47ba704efad78e0ba9b9a9.html">audio</a></li><li class="navelem"><a class="el" href="alsacapture_8c.html">alsacapture.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
