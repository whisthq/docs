<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>scaling_algorithms - Whist Backend Services</title>

<link type="text/css" rel="stylesheet" href="https://docs.whist.com/backend/services//lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/jquery.js" defer></script>




<script>var goVersion = "go1.17.7";</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/godocs.js" defer></script>

</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services | Autogenerated from 722f990</a></div>
<div class="top-heading" id="heading-narrow"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package scaling_algorithms
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/whisthq/whist/backend/services/scaling-service/scaling_algorithms/default"</code></dd>
			</dl>
			<dl>
			<dd><a href="#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
				<dd><a href="#pkg-constants">Constants</a></dd>
			
			
			
				
				<dd><a href="#GetEnabledRegions">func GetEnabledRegions() []string</a></dd>
			
			
				
				<dd><a href="#DefaultScalingAlgorithm">type DefaultScalingAlgorithm</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.CreateDBClient">func (s *DefaultScalingAlgorithm) CreateDBClient(dbClient dbclient.WhistDBClient)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.CreateEventChans">func (s *DefaultScalingAlgorithm) CreateEventChans()</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.CreateGraphQLClient">func (s *DefaultScalingAlgorithm) CreateGraphQLClient(client subscriptions.WhistGraphQLClient)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.GetConfig">func (s *DefaultScalingAlgorithm) GetConfig(client subscriptions.WhistGraphQLClient)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.MandelboxAssign">func (s *DefaultScalingAlgorithm) MandelboxAssign(scalingCtx context.Context, event ScalingEvent) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.ProcessEvents">func (s *DefaultScalingAlgorithm) ProcessEvents(globalCtx context.Context, goroutineTracker *sync.WaitGroup)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.ScaleDownIfNecessary">func (s *DefaultScalingAlgorithm) ScaleDownIfNecessary(scalingCtx context.Context, event ScalingEvent) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.ScaleUpIfNecessary">func (s *DefaultScalingAlgorithm) ScaleUpIfNecessary(instancesToScale int, scalingCtx context.Context, event ScalingEvent, imageID string) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.SwapOverImages">func (s *DefaultScalingAlgorithm) SwapOverImages(scalingCtx context.Context, event ScalingEvent, clientVersion interface{}) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.UpgradeImage">func (s *DefaultScalingAlgorithm) UpgradeImage(scalingCtx context.Context, event ScalingEvent, imageID interface{}) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.VerifyCapacity">func (s *DefaultScalingAlgorithm) VerifyCapacity(scalingCtx context.Context, event ScalingEvent) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#DefaultScalingAlgorithm.VerifyInstanceScaleDown">func (s *DefaultScalingAlgorithm) VerifyInstanceScaleDown(scalingCtx context.Context, event ScalingEvent, instance subscriptions.Instance) error</a></dd>
				
			
				
				<dd><a href="#ScalingAlgorithm">type ScalingAlgorithm</a></dd>
				
				
			
				
				<dd><a href="#ScalingEvent">type ScalingEvent</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go">actions.go</a>
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/config.go">config.go</a>
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go">default.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
			<h2 id="pkg-constants">Constants</h2>
			
				
				<pre>const (
    <span id="CLIENT_COMMIT_HASH_DEV_OVERRIDE">CLIENT_COMMIT_HASH_DEV_OVERRIDE</span> = &#34;local_dev&#34;

    <span class="comment">// Instance was found but the client app is out of date</span>
    <span id="COMMIT_HASH_MISMATCH">COMMIT_HASH_MISMATCH</span> = &#34;COMMIT_HASH_MISMATCH&#34;

    <span class="comment">// No instance was found e.g. a capacity issue</span>
    <span id="NO_INSTANCE_AVAILABLE">NO_INSTANCE_AVAILABLE</span> = &#34;NO_INSTANCE_AVAILABLE&#34;

    <span class="comment">// The requested region(s) have not been enabled</span>
    <span id="REGION_NOT_ENABLED">REGION_NOT_ENABLED</span> = &#34;REGION_NOT_ENABLED&#34;

    <span class="comment">// User is already connected to a mandelbox, possibly on another device</span>
    <span id="USER_ALREADY_ACTIVE">USER_ALREADY_ACTIVE</span> = &#34;USER_ALREADY_ACTIVE&#34;
)</pre>
			
				<p>
VCPUsPerMandelbox indicates the number of vCPUs allocated per mandelbox.
</p>

				<pre>const <span id="VCPUsPerMandelbox">VCPUsPerMandelbox</span> = 4</pre>
			
		
		
		
			
			
			<h2 id="GetEnabledRegions">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/config.go#L94">GetEnabledRegions</a>
				<a class="permalink" href="#GetEnabledRegions">&#xb6;</a>
				
				
			</h2>
			<pre>func GetEnabledRegions() []<a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a></pre>
			<p>
GetEnabledRegions returns a list of regions where the backend resources required
to run Whist exist, according to the current environment.
</p>

			
			

		
		
			
			
			<h2 id="DefaultScalingAlgorithm">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L37">DefaultScalingAlgorithm</a>
				<a class="permalink" href="#DefaultScalingAlgorithm">&#xb6;</a>
				
				
			</h2>
			<p>
DefaultScalingAlgorithm abstracts the shared functionalities to be used
by all of the different, region-based scaling algorithms.
</p>

			<pre>type DefaultScalingAlgorithm struct {
<span id="DefaultScalingAlgorithm.Host"></span>    Host                 <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/hosts/">hosts</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/hosts/#HostHandler">HostHandler</a>
<span id="DefaultScalingAlgorithm.GraphQLClient"></span>    GraphQLClient        <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>
<span id="DefaultScalingAlgorithm.DBClient"></span>    DBClient             <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/">dbclient</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/#WhistDBClient">WhistDBClient</a>
<span id="DefaultScalingAlgorithm.Region"></span>    Region               <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>
<span id="DefaultScalingAlgorithm.InstanceEventChan"></span>    InstanceEventChan    chan <a href="#ScalingEvent">ScalingEvent</a>
<span id="DefaultScalingAlgorithm.ImageEventChan"></span>    ImageEventChan       chan <a href="#ScalingEvent">ScalingEvent</a>
<span id="DefaultScalingAlgorithm.ClientAppVersionChan"></span>    ClientAppVersionChan chan <a href="#ScalingEvent">ScalingEvent</a>
<span id="DefaultScalingAlgorithm.ScheduledEventChan"></span>    ScheduledEventChan   chan <a href="#ScalingEvent">ScalingEvent</a>
<span id="DefaultScalingAlgorithm.ServerEventChan"></span>    ServerEventChan      chan <a href="#ScalingEvent">ScalingEvent</a>
<span id="DefaultScalingAlgorithm.SyncChan"></span>    SyncChan             chan <a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a> <span class="comment">// This channel is used to sync actions</span>
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="DefaultScalingAlgorithm.CreateDBClient">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L84">CreateDBClient</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.CreateDBClient">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) CreateDBClient(dbClient <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/">dbclient</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/#WhistDBClient">WhistDBClient</a>)</pre>
				<p>
CreateDBClient sets the DBClient to be used when interacting with the database.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.CreateEventChans">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L53">CreateEventChans</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.CreateEventChans">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) CreateEventChans()</pre>
				<p>
CreateEventChans creates the event channels if they don&#39;t alredy exist.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.CreateGraphQLClient">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L77">CreateGraphQLClient</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.CreateGraphQLClient">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) CreateGraphQLClient(client <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>)</pre>
				<p>
CreateGraphQLClient sets the graphqlClient to be used by the DBClient for queries and mutations.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.GetConfig">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L93">GetConfig</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.GetConfig">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) GetConfig(client <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>)</pre>
				<p>
GetConfig will query the configuration database and populate the configuration variables
according to the environment the scaling service is running in. It&#39;s necessary to perform
the query before starting to receive any scaling events.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.MandelboxAssign">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L559">MandelboxAssign</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.MandelboxAssign">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) MandelboxAssign(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
MandelboxAssign is the action responsible for assigning an instance to a user,
and scaling as necessary to satisfy demand.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.ProcessEvents">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L145">ProcessEvents</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.ProcessEvents">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) ProcessEvents(globalCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, goroutineTracker *<a href="https:/docs.whist.com/backend/services/pkg/sync/">sync</a>.<a href="https:/docs.whist.com/backend/services/pkg/sync/#WaitGroup">WaitGroup</a>)</pre>
				<p>
ProcessEvents is the main function of the scaling algorithm, it is responsible of processing
events and executing the appropiate scaling actions. This function is specific for each region
scaling algorithm to be able to implement different strategies on each region.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.ScaleDownIfNecessary">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L132">ScaleDownIfNecessary</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.ScaleDownIfNecessary">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) ScaleDownIfNecessary(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
ScaleDownIfNecessary is a scaling action which runs every 10 minutes and scales down free and
lingering instances, respecting the buffer defined for each region. Free instances will be
marked as draining, and lingering instances will be terminated and removed from the database.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.ScaleUpIfNecessary">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L300">ScaleUpIfNecessary</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.ScaleUpIfNecessary">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) ScaleUpIfNecessary(instancesToScale <a href="https:/docs.whist.com/backend/services/pkg/builtin/#int">int</a>, scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>, imageID <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
ScaleUpIfNecessary is a scaling action that launched the received number of instances on
the cloud provider and registers them on the database with the initial values.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.SwapOverImages">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L465">SwapOverImages</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.SwapOverImages">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) SwapOverImages(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>, clientVersion interface{}) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
SwapOverImages is a scaling action that will switch the current image on the given region.
To the latest one. This is done separately to avoid having downtimes during deploys, since
we have to wait until the frontend has updated its version on the config database.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.UpgradeImage">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L353">UpgradeImage</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.UpgradeImage">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) UpgradeImage(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>, imageID interface{}) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
UpgradeImage is a scaling action which runs when a new version is deployed. Its responsible of
starting a buffer of instances with the new image and scaling down instances with the previous
image.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.VerifyCapacity">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L83">VerifyCapacity</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.VerifyCapacity">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) VerifyCapacity(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
VerifyCapacity is a scaling action which checks the database to verify if we have the desired
capacity (instance buffer). This action is run at the end of the other actions.
</p>

				
				
				
			
				
				<h3 id="DefaultScalingAlgorithm.VerifyInstanceScaleDown">func (*DefaultScalingAlgorithm) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/actions.go#L21">VerifyInstanceScaleDown</a>
					<a class="permalink" href="#DefaultScalingAlgorithm.VerifyInstanceScaleDown">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="#DefaultScalingAlgorithm">DefaultScalingAlgorithm</a>) VerifyInstanceScaleDown(scalingCtx <a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, event <a href="#ScalingEvent">ScalingEvent</a>, instance <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#Instance">Instance</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
VerifyInstanceScaleDown is a scaling action which fires when an instance is marked as DRAINING
on the database. Its purpose is to verify and wait until the instance is terminated from the
cloud provider and removed from the database, if it doesn&#39;t it takes the necessary steps to
notify and ensure the database and the cloud provider don&#39;t get out of sync.
</p>

				
				
				
			
		
			
			
			<h2 id="ScalingAlgorithm">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L18">ScalingAlgorithm</a>
				<a class="permalink" href="#ScalingAlgorithm">&#xb6;</a>
				
				
			</h2>
			<p>
ScalingAlgorithm is the basic abstraction of the scaling service
that receives a stream of events and makes calls to the host handler.
</p>

			<pre>type ScalingAlgorithm interface {
    ProcessEvents(<a href="https:/docs.whist.com/backend/services/pkg/context/">context</a>.<a href="https:/docs.whist.com/backend/services/pkg/context/#Context">Context</a>, *<a href="https:/docs.whist.com/backend/services/pkg/sync/">sync</a>.<a href="https:/docs.whist.com/backend/services/pkg/sync/#WaitGroup">WaitGroup</a>)
    CreateEventChans()
    CreateGraphQLClient(<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>)
    CreateDBClient(<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/">dbclient</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/scaling-service/dbclient/#WhistDBClient">WhistDBClient</a>)
    GetConfig(<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>)
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="ScalingEvent">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/scaling_algorithms/default/default.go#L28">ScalingEvent</a>
				<a class="permalink" href="#ScalingEvent">&#xb6;</a>
				
				
			</h2>
			<p>
ScalingEvent is an event that contains all the relevant information
to make scaling decisions.
</p>

			<pre>type ScalingEvent struct {
<span id="ScalingEvent.ID"></span>    ID     <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>
<span id="ScalingEvent.Type"></span>    Type   interface{} <span class="comment">// The type of event (database, timing, etc.)</span>
<span id="ScalingEvent.Data"></span>    Data   interface{} <span class="comment">// Data relevant to the event</span>
<span id="ScalingEvent.Region"></span>    Region <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>      <span class="comment">// Region where the scaling will be performed</span>
}
</pre>

			

			

			
			
			

			

			
		
	

	







<div id="footer">
Build version go1.17.7.<br>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
