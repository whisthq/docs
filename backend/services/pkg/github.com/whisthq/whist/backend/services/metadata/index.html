<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>metadata - Whist Backend Services</title>

<link type="text/css" rel="stylesheet" href="https://docs.whist.com/backend/services//lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/jquery.js" defer></script>




<script>var goVersion = "go1.19.2";</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/godocs.js" defer></script>

</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services | Autogenerated from 8f8fca0</a></div>
<div class="top-heading" id="heading-narrow"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package metadata
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/whisthq/whist/backend/services/metadata"</code></dd>
			</dl>
			<dl>
			<dd><a href="#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="#pkg-index" class="indexLink">Index</a></dd>
			
			
				<dd><a href="#pkg-subdirectories">Subdirectories</a></dd>
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package metadata exposes some metadata about the build and run environments of the host-service.

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
				<dd><a href="#pkg-variables">Variables</a></dd>
			
			
				
				<dd><a href="#GenerateCloudMetadataRetriever">func GenerateCloudMetadataRetriever() error</a></dd>
			
				
				<dd><a href="#GetAppEnvironmentLowercase">func GetAppEnvironmentLowercase() string</a></dd>
			
				
				<dd><a href="#GetGitCommit">func GetGitCommit() string</a></dd>
			
				
				<dd><a href="#IsGPU">func IsGPU() bool</a></dd>
			
				
				<dd><a href="#IsLocalEnv">func IsLocalEnv() bool</a></dd>
			
				
				<dd><a href="#IsLocalEnvWithoutDB">func IsLocalEnvWithoutDB() bool</a></dd>
			
				
				<dd><a href="#IsRunningInCI">func IsRunningInCI() bool</a></dd>
			
			
				
				<dd><a href="#AppEnvironment">type AppEnvironment</a></dd>
				
				
			
				
				<dd><a href="#CloudMetadataRetriever">type CloudMetadataRetriever</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go">environment.go</a>
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/metadata.go">metadata.go</a>
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/providers.go">providers.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
			<h2 id="pkg-variables">Variables</h2>
			
				<p>GetAppEnvironment returns the AppEnvironment of the current instance.

				<pre>var <span id="GetAppEnvironment">GetAppEnvironment</span> func() <a href="#AppEnvironment">AppEnvironment</a> = func(unmemoized func() <a href="#AppEnvironment">AppEnvironment</a>) func() <a href="#AppEnvironment">AppEnvironment</a> {

    var <span id="isCached">isCached</span> = <a href="https:/docs.whist.com/backend/services/pkg/builtin/#false">false</a>
    var <span id="cache">cache</span> <a href="#AppEnvironment">AppEnvironment</a>

    return func() <a href="#AppEnvironment">AppEnvironment</a> {
        if isCached {
            return cache
        }
        cache = unmemoized()
        isCached = <a href="https:/docs.whist.com/backend/services/pkg/builtin/#true">true</a>
        return cache
    }
}(func() <a href="#AppEnvironment">AppEnvironment</a> {

    env := <a href="https:/docs.whist.com/backend/services/pkg/strings/">strings</a>.<a href="https:/docs.whist.com/backend/services/pkg/strings/#ToLower">ToLower</a>(<a href="https:/docs.whist.com/backend/services/pkg/os/">os</a>.<a href="https:/docs.whist.com/backend/services/pkg/os/#Getenv">Getenv</a>(&#34;APP_ENV&#34;))
    switch env {
    case &#34;development&#34;, &#34;dev&#34;:
        return <a href="#EnvDev">EnvDev</a>
    case &#34;staging&#34;:
        return <a href="#EnvStaging">EnvStaging</a>
    case &#34;production&#34;, &#34;prod&#34;:
        return <a href="#EnvProd">EnvProd</a>
    case &#34;localdevwithdb&#34;, &#34;localdev_with_db&#34;, &#34;localdev_with_database&#34;:
        return <a href="#EnvLocalDevWithDB">EnvLocalDevWithDB</a>
    default:
        return <a href="#EnvLocalDev">EnvLocalDev</a>
    }
})</pre>
			
		
		
			
			
			<h2 id="GenerateCloudMetadataRetriever">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/providers.go#L42">GenerateCloudMetadataRetriever</a>
				<a class="permalink" href="#GenerateCloudMetadataRetriever">&#xb6;</a>
				
				
			</h2>
			<pre>func GenerateCloudMetadataRetriever() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
			<p>GenerateCloudMetadataRetriever tries to identify the current cloud provider
the instance is running in by pinging the metadata endpoints. It tries to be
smart about this by pinging the endpoints in order of provider adoption so that
the most used provider is first. Unless there is need for creating a retriever
for a specific provider, this function should be used to generate a new metadata
retriever instead of directly instanciating a new metadata retriever.

			
			

		
			
			
			<h2 id="GetAppEnvironmentLowercase">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L85">GetAppEnvironmentLowercase</a>
				<a class="permalink" href="#GetAppEnvironmentLowercase">&#xb6;</a>
				
				
			</h2>
			<pre>func GetAppEnvironmentLowercase() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a></pre>
			<p>GetAppEnvironmentLowercase returns the app environment string, but just
converted to lowercase. This is helpful to construct larger strings (i.e.
Docker image names) that depend on the current environment.

			
			

		
			
			
			<h2 id="GetGitCommit">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/metadata.go#L10">GetGitCommit</a>
				<a class="permalink" href="#GetGitCommit">&#xb6;</a>
				
				
			</h2>
			<pre>func GetGitCommit() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a></pre>
			<p>GetGitCommit returns the git commit hash of this build.

			
			

		
			
			
			<h2 id="IsGPU">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L107">IsGPU</a>
				<a class="permalink" href="#IsGPU">&#xb6;</a>
				
				
			</h2>
			<pre>func IsGPU() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a></pre>
			<p>IsGPU returns true if the host-service is running on a host with
a GPU and false otherwise. False is the default behaviour and
the host service will only run on GPU instances when the
GPU flag is set.

			
			

		
			
			
			<h2 id="IsLocalEnv">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L70">IsLocalEnv</a>
				<a class="permalink" href="#IsLocalEnv">&#xb6;</a>
				
				
			</h2>
			<pre>func IsLocalEnv() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a></pre>
			<p>IsLocalEnv returns true if this host service is running locally for
development.

			
			

		
			
			
			<h2 id="IsLocalEnvWithoutDB">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L77">IsLocalEnvWithoutDB</a>
				<a class="permalink" href="#IsLocalEnvWithoutDB">&#xb6;</a>
				
				
			</h2>
			<pre>func IsLocalEnvWithoutDB() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a></pre>
			<p>IsLocalEnvWithoutDB returns true if this host service is running locally for
development but without the database enabled.

			
			

		
			
			
			<h2 id="IsRunningInCI">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L91">IsRunningInCI</a>
				<a class="permalink" href="#IsRunningInCI">&#xb6;</a>
				
				
			</h2>
			<pre>func IsRunningInCI() <a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a></pre>
			<p>IsRunningInCI returns true if the host-service is running in continuous
integration (i.e. for tests), and false otherwise.

			
			

		
		
			
			
			<h2 id="AppEnvironment">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/environment.go#L22">AppEnvironment</a>
				<a class="permalink" href="#AppEnvironment">&#xb6;</a>
				
				
			</h2>
			<p>An AppEnvironment represents either localdev or localdevwithdb (i.e. an engineer&apos;s
development instance), dev (i.e. talking to the dev scaling service), staging, or prod

			<pre>type AppEnvironment <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a></pre>

			
				<p>Constants for the various AppEnvironments. DO NOT CHANGE THESE without
understanding how any consumers of GetAppEnvironment() and
GetAppEnvironmentLowercase() are using them!

				<pre>const (
    <span id="EnvLocalDevWithDB">EnvLocalDevWithDB</span> <a href="#AppEnvironment">AppEnvironment</a> = &#34;localdevwithdb&#34;
    <span id="EnvLocalDev">EnvLocalDev</span>       <a href="#AppEnvironment">AppEnvironment</a> = &#34;localdev&#34;
    <span id="EnvDev">EnvDev</span>            <a href="#AppEnvironment">AppEnvironment</a> = &#34;dev&#34;
    <span id="EnvStaging">EnvStaging</span>        <a href="#AppEnvironment">AppEnvironment</a> = &#34;staging&#34;
    <span id="EnvProd">EnvProd</span>           <a href="#AppEnvironment">AppEnvironment</a> = &#34;prod&#34;
)</pre>
			

			

			
			
			

			

			
		
			
			
			<h2 id="CloudMetadataRetriever">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/metadata/providers.go#L25">CloudMetadataRetriever</a>
				<a class="permalink" href="#CloudMetadataRetriever">&#xb6;</a>
				
				
			</h2>
			<p>CloudMetadataRetriever is an interface that abstracts all functionality
to get metadata from an instance. It allows consumers of this package to
get the desired metadata without having any provider-specific logic.

			<pre>type CloudMetadataRetriever interface {
    GetImageID() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#ImageID">ImageID</a>
    GetInstanceID() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#InstanceID">InstanceID</a>
    GetInstanceType() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#InstanceType">InstanceType</a>
    GetInstanceName() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#InstanceName">InstanceName</a>
    GetPlacementRegion() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#PlacementRegion">PlacementRegion</a>
    GetPublicIpv4() <a href="https:/docs.whist.com/backend/services/pkg/net/">net</a>.<a href="https:/docs.whist.com/backend/services/pkg/net/#IP">IP</a>
    PopulateMetadata() (map[<a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>]<a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>, *multierror.<a href="#Error">Error</a>)
    GetUserID() <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/">types</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/types/#UserID">UserID</a>
}</pre>

			

			
				<p>CloudMetadata is a variable exposed by this package so that any
consumers can get the relevant metadata that was queried from the
cloud provider.

				<pre>var <span id="CloudMetadata">CloudMetadata</span> <a href="#CloudMetadataRetriever">CloudMetadataRetriever</a></pre>
			

			
			
			

			

			
		
	

	





	
	
		<h2 id="pkg-subdirectories">Subdirectories</h2>
	
	<div class="pkg-dir">
		<table>
			<tr>
				<th class="pkg-name">Name</th>
				<th class="pkg-synopsis">Synopsis</th>
			</tr>

			
			<tr>
				<td colspan="2"><a href="..">..</a></td>
			</tr>
			

			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="aws/">aws</a>
					</td>
				
					<td class="pkg-synopsis">
						Package aws abstracts away the collection and caching of important runtime metadata about the AWS instance the host service is running on.
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="gcp/">gcp</a>
					</td>
				
					<td class="pkg-synopsis">
						
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="heroku/">heroku</a>
					</td>
				
					<td class="pkg-synopsis">
						Package heroku contains code to pull configuration variables from Heroku at runtime.
					</td>
				</tr>
			
		</table>
	</div>



<div id="footer">
Build version go1.19.2.<br>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
