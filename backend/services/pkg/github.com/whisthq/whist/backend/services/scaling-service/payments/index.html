<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>payments - Whist Backend Services</title>

<link type="text/css" rel="stylesheet" href="https://docs.whist.com/backend/services//lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/jquery.js" defer></script>




<script>var goVersion = "go1.18.1";</script>
<script src="https://docs.whist.com/backend/services//lib/godoc/godocs.js" defer></script>

</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services | Autogenerated from d622e56</a></div>
<div class="top-heading" id="heading-narrow"><a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/">Whist Backend Services</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package payments
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/whisthq/whist/backend/services/scaling-service/payments"</code></dd>
			</dl>
			<dl>
			<dd><a href="#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
				
				<dd><a href="#VerifyPayment">func VerifyPayment(accessToken string) (bool, error)</a></dd>
			
			
				
				<dd><a href="#PaymentsClient">type PaymentsClient</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#PaymentsClient.CreateSession">func (whistPayments *PaymentsClient) CreateSession() (string, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#PaymentsClient.Initialize">func (whistPayments *PaymentsClient) Initialize(customerID string, subscriptionStatus string, configGraphqlClient subscriptions.WhistGraphQLClient, stripeClient WhistStripeClient) error</a></dd>
				
			
				
				<dd><a href="#StripeClient">type StripeClient</a></dd>
				
				
			
				
				<dd><a href="#WhistStripeClient">type WhistStripeClient</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/payments.go">payments.go</a>
			
				<a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/stripe.go">stripe.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
			
			
			<h2 id="VerifyPayment">func <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/payments.go#L142">VerifyPayment</a>
				<a class="permalink" href="#VerifyPayment">&#xb6;</a>
				
				
			</h2>
			<pre>func VerifyPayment(accessToken <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>) (<a href="https:/docs.whist.com/backend/services/pkg/builtin/#bool">bool</a>, <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a>)</pre>
			<p>
VerifyPayment takes an access token and extracts the claims within it.
Once it has obtained the claims, it checks if the customer has an active
Stripe subscription using the subscription status custom claim.
</p>

			
			

		
		
			
			
			<h2 id="PaymentsClient">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/payments.go#L19">PaymentsClient</a>
				<a class="permalink" href="#PaymentsClient">&#xb6;</a>
				
				
			</h2>
			<p>
PaymentsClient is a wrapper struct that will call our
own Stripe client and allow testing. Packages that handle
payments should use this struct.
</p>

			<pre>type PaymentsClient struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="PaymentsClient.CreateSession">func (*PaymentsClient) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/payments.go#L94">CreateSession</a>
					<a class="permalink" href="#PaymentsClient.CreateSession">&#xb6;</a>
					
					
				</h3>
				<pre>func (whistPayments *<a href="#PaymentsClient">PaymentsClient</a>) CreateSession() (<a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>, <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a>)</pre>
				<p>
CreateSession is the method exposed to other packages for getting a Stripe Session URL.
It should only be called after `Initialize` has been run first. It decides what kind of
Stripe Session to return based on the customer&#39;s subscription status.
</p>

				
				
				
			
				
				<h3 id="PaymentsClient.Initialize">func (*PaymentsClient) <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/payments.go#L26">Initialize</a>
					<a class="permalink" href="#PaymentsClient.Initialize">&#xb6;</a>
					
					
				</h3>
				<pre>func (whistPayments *<a href="#PaymentsClient">PaymentsClient</a>) Initialize(customerID <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>, subscriptionStatus <a href="https:/docs.whist.com/backend/services/pkg/builtin/#string">string</a>, configGraphqlClient <a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/">subscriptions</a>.<a href="https:/docs.whist.com/backend/services/pkg/github.com/whisthq/whist/backend/services/subscriptions/#WhistGraphQLClient">WhistGraphQLClient</a>, stripeClient <a href="#WhistStripeClient">WhistStripeClient</a>) <a href="https:/docs.whist.com/backend/services/pkg/builtin/#error">error</a></pre>
				<p>
Initialize will pull all necessary configurations from the database
and set the StripeClient fields with the values extracted from
the access token.
</p>

				
				
				
			
		
			
			
			<h2 id="StripeClient">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/stripe.go#L32">StripeClient</a>
				<a class="permalink" href="#StripeClient">&#xb6;</a>
				
				
			</h2>
			<p>
StripeClient interacts directly with the official
Stripe client.
</p>

			<pre>type StripeClient struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="WhistStripeClient">type <a href="https://github.com/whisthq/whist/blob/dev/backend/services/scaling-service/payments/stripe.go#L19">WhistStripeClient</a>
				<a class="permalink" href="#WhistStripeClient">&#xb6;</a>
				
				
			</h2>
			<p>
WhistStripeClient abstracts our own Stripe Client with the necessary
methods to process payments for users. Structs that implement it should
encapsulate the logic that uses the official Stripe SDK.
</p>

			<pre>type WhistStripeClient interface {
    <span class="comment">// contains filtered or unexported methods</span>
}</pre>

			

			

			
			
			

			

			
		
	

	







<div id="footer">
Build version go1.18.1.<br>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
